/*
 * openDSME
 *
 * Implementation of the Deterministic & Synchronous Multi-channel Extension (DSME)
 * introduced in the IEEE 802.15.4e-2012 standard
 *
 * Authors: Florian Meier <florian.meier@tuhh.de>
 *          Maximilian Koestler <maximilian.koestler@tuhh.de>
 *          Sandrina Backhauss <sandrina.backhauss@tuhh.de>
 *
 * Based on
 *          DSME Implementation for the INET Framework
 *          Tobias Luebkert <tobias.luebkert@tuhh.de>
 *
 * Copyright (c) 2015, Institute of Telematics, Hamburg University of Technology
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the Institute nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */

#ifndef NEURALNETWORK_H_
#define NEURALNETWORK_H_

#include "./quicknet/Math.h"
#include "./quicknet/Network.h"

namespace dsme {

template<typename T>
class NeuralNetwork {
public:
    NeuralNetwork();
    ~NeuralNetwork() = default;

    quicknet::Vector<T>& feedForward(quicknet::Vector<T>& input) {
        return this->network.feedForward(input);
    }

private:
    quicknet::Network<T> network;
};

/***IMPLEMENTATION***/

typedef quicknet::Layer<float> layer_t;
typedef quicknet::Vector<float> vector_t;
typedef quicknet::Matrix<float> matrix_t;

/******** Layer 0 ********/
static const float l0_weights_array[392] {
    -0.05070215,-0.84514517,0.60552734,0.51408988,-0.60826355,-0.41753978,-0.19750176,-0.10843994,-0.15214811,-0.31798393,0.25786442,0.50740051,-0.30915323,0.64658719,
    -0.29698929,-0.32913378,-0.01781087,0.01040892,-0.81246072,-0.59550858,0.12080832,-0.04177892,0.38356182,-0.43044162,-0.01908720,0.09705207,-0.21875513,-0.17089452,
    -0.28730601,0.01720264,-0.21377802,-0.37782797,-0.02847863,0.67133129,-0.14237019,-0.07932161,-0.88103318,-0.66749167,-0.10094752,0.06135653,0.25055408,0.69356549,
    -0.37890455,-0.23829825,-0.06252915,-0.38384107,0.51034707,-0.15330364,0.54123479,-0.05868689,-0.09810556,-0.27239096,0.28349450,0.01481646,0.77957022,0.66431934,
    -0.35369551,0.55563468,-0.31023747,0.16132899,0.02343232,-0.53797001,0.43518400,-0.47028649,0.03638301,-0.66672128,-0.08023585,-0.54578841,-0.56587213,-0.07739384,
    0.27614442,0.55158305,-0.19098927,-0.19263682,-0.34798649,-0.44031984,1.12748659,-0.09104650,-0.00913351,0.50708318,0.13947034,-0.47841570,-0.06794788,0.66218382,
    -0.30116135,0.45937666,0.39444804,-0.12452387,0.09397283,-0.53925139,-0.44105217,0.40314648,0.12374935,-0.29080510,-0.35663632,-0.36720005,0.01998040,-0.01635085,
    0.29905760,-0.31516501,-0.01686680,-0.68527502,-0.30478781,-0.00838985,-0.24703275,0.12009209,-0.11058052,-0.30136076,0.24350075,0.18888867,-0.15036163,-0.19083701,
    -0.55608767,-0.06333989,-0.58098704,-0.06254006,-0.08056561,0.47863129,-0.23573418,-0.01446691,-0.28408876,-0.10924345,0.09526858,0.15047020,-0.38661179,0.82127142,
    -0.52455974,-0.00354065,-0.67591864,0.33400679,0.22100639,0.24838243,-0.01968691,-0.48273176,-0.53947192,-0.37614790,0.41175419,-0.70052403,0.12275882,0.05211226,
    -0.21495076,0.61218840,0.94663596,0.28879440,0.46910053,0.38224488,-0.05073466,-0.32416284,-0.23489583,-0.17503487,0.86211407,0.12948003,-0.18852316,-0.41807157,
    0.20821159,-0.66532010,0.09445185,0.29549989,-0.13282782,-0.38849717,0.93374848,-0.48764756,-0.04554931,0.56558055,-0.03817182,-0.83470839,0.31638521,0.20257759,
    0.00441702,-0.20444877,-0.24216910,-0.68133110,0.00549012,-0.56737494,-0.57274574,-0.48161474,0.03002815,-0.43450728,0.20654598,-0.23157632,-0.06537502,0.04996816,
    0.31795007,0.04529955,0.38631383,0.63856941,0.53886616,0.65248334,0.38223654,0.03133196,0.16207886,0.10470024,0.35183033,0.21593440,-0.29505703,0.26512203,
    -0.35697216,-0.47296637,0.01313745,0.43911746,0.17319876,-0.66547036,-0.59976786,-0.09531341,-0.03387714,0.04293550,-0.18088008,-0.20479628,0.18003024,0.28114882,
    0.62723106,-0.11646362,-0.20087039,-0.29393828,-0.40745205,-0.85260832,0.61772370,0.21541627,0.17577326,0.65416169,-0.06518608,-0.42662400,-0.33311540,0.09919821,
    -0.19306864,0.21696195,-0.55914235,-0.30552402,-0.01478589,0.41317749,-0.24651720,-0.57345098,0.73310846,0.03167515,-0.56542867,0.71770960,0.36250645,-0.13414478,
    0.75916940,0.04177128,0.28305298,-0.59509814,0.20505124,0.02914149,-0.44031441,-0.23096263,0.24261612,-0.03857030,0.03474877,-0.20166898,-0.44976282,0.63802576,
    0.08889913,0.62262303,0.26216537,-0.28956464,0.02805791,-0.26506037,0.51820022,0.21000458,-0.02655189,-0.03786192,0.26406246,0.41237924,0.56905049,0.39423907,
    -0.54610229,0.26442057,-0.22642504,-0.06444465,-0.69942248,-0.64655203,-0.34447291,-0.00682472,-0.14581649,-0.29757157,-0.57219374,-0.22793402,-0.05873050,0.35122126,
    0.24336061,-0.26062104,-0.32082683,0.56897157,-0.36887735,-0.25261837,-0.43883836,0.77884412,-0.05279071,0.14134511,1.43526876,0.14498551,0.47944623,0.25950885,
    0.13665089,-0.68496078,-0.49053434,-0.60256958,0.28104579,-0.01091247,0.87010813,-0.24514867,-0.59172177,-0.34346056,-0.61115420,-0.23271017,0.15368539,-0.06100721,
    0.47285950,0.01803844,0.15073150,0.06862845,-0.06997057,0.92186409,0.05047136,-0.04300549,-0.04350244,-0.44624105,-0.06201288,-0.80295342,-0.34120509,0.44488391,
    -0.11193399,-0.54822326,-0.31960934,-0.39053944,0.03310398,-0.26474303,-0.68265110,-0.20754826,-0.34329224,-0.21839574,0.09076525,0.00565451,-0.25481823,-0.31665626,
    0.60554987,-0.55643094,0.29330817,0.24492812,0.83104277,0.10085195,-0.13087216,0.18962985,-0.28773183,-0.09803843,-0.93316561,-0.00778515,0.65219957,0.13195771,
    0.12328405,0.17577784,0.46656674,-0.55892146,-0.32017320,-0.13183720,0.39021990,-0.17086397,0.33369535,0.26376399,0.37035501,0.19110742,0.37125456,0.01027718,
    0.33164722,0.89809680,0.36831483,0.11710940,0.32054198,-0.60366368,0.32706705,0.40272987,-0.03375079,0.13138548,0.08407377,0.03163442,-0.20635259,0.01699070,
    -0.98656887,-0.10006297,-0.17774786,-0.73569590,-0.45632935,-0.17583556,-0.18091531,0.24628317,-0.27133042,0.08420663,-0.10862598,-0.36551252,-0.38133660,-0.31420511,
};
static float l0_bias_array[28] {
    -0.09741614,-0.08175260,-0.01392906,0.16439152,-0.27168331,0.07956324,0.09425872,-0.04481335,-0.07062801,-0.22698151,0.00375849,-0.11116597,-0.06702089,0.03527405,0.02188134,-0.13937300,-0.00545873,-0.02440039,0.22179741,-0.00534449,0.42004773,-0.28744254,-0.06106278,-0.21190013,-0.02954007,0.12704319,-0.01024595,-0.19860958
};
static float l0_output_array[28];

static matrix_t l0_weights{28,14,l0_weights_array};
static vector_t l0_bias{28,l0_bias_array};
static vector_t l0_output{28,l0_output_array};

/******** Layer 1 ********/
static const float l1_weights_array[784] {
    -0.22704063,-0.58383763,-0.22496721,-0.54409778,-0.22142777,-0.21276832,-0.46902314,0.40811545,0.03495657,-0.37068596,0.12658340,-0.24751097,0.16052656,0.57772988,-0.69004065,0.05746368,0.41599852,0.62502754,0.19071069,-0.30929109,-0.50214016,-0.12811972,0.36210465,-0.11469495,-0.03319883,0.35830104,0.28984594,-0.68715644,
    0.15474895,-0.44731477,0.12510008,0.02636572,0.01122296,0.30566227,-0.33276796,-0.13800955,0.40100005,0.08068134,0.18934582,0.44688743,-0.28152615,0.63237834,-0.27532634,0.40231532,-0.53097451,-0.27818835,-0.38863292,-0.13539881,0.48360512,-0.23885019,-0.18526056,-0.20359108,-0.41074890,-0.08651920,-0.29168954,0.15881780,
    -0.20389725,-0.14417779,-0.18214242,-0.54114634,0.27429092,-0.24970131,0.30799755,0.27980641,-0.39461538,-0.03948065,-0.26308236,-0.34618929,-0.14356363,-0.57049519,0.35086524,0.07763065,-0.25927600,0.53196710,-0.21481533,0.29839438,-0.41156706,-0.11842073,0.37860033,0.64216274,0.72881460,-0.04871126,-0.04487328,0.20498651,
    -0.00763145,-0.17476423,0.46298587,0.40470156,-0.39141652,-0.13751836,0.09301995,-0.04526816,0.63989216,0.64427578,0.54809338,-0.24366082,-0.56770813,0.14016224,0.18776985,-0.62364358,0.04035945,-0.40414324,-0.39141977,-0.13138771,-0.62513733,-0.31816864,0.10008210,0.07603558,-0.08691383,-0.21041413,-0.31257433,0.69766629,
    0.19453034,0.14224187,-0.04421127,0.55593276,-0.59346300,-0.39327562,-0.58544344,0.63110161,-0.35927826,-0.03159412,0.26297688,0.01530773,0.33848631,-0.36976480,-0.10456703,0.24519810,0.11569309,-0.33068448,-0.20139520,-0.73489833,0.27416608,0.34942019,-0.08119630,0.54912078,-0.21119384,0.28087676,-0.76087725,-0.04282903,
    -0.59955245,-0.51123947,-0.30374667,-0.36593083,0.50768769,0.35797697,0.30247006,-0.37162742,-0.00604427,0.44450426,0.33057597,-0.16355319,-0.24652383,-0.14878240,-0.28567046,0.45770520,-0.34332323,-0.16328879,0.24982789,0.04111078,-0.07979451,0.01833682,0.11701228,-0.29742703,-0.08125615,-0.31461450,0.53768533,-0.05915387,
    0.31055534,-0.20332879,-0.59203285,0.20264407,0.27392024,0.39085841,-0.32992992,-0.05437293,0.10825043,-0.01332224,-0.13494232,0.95349723,0.32626569,0.01601387,0.31931448,0.71438593,-0.46432549,-0.17583644,-0.33708182,-0.09473342,-0.22696586,0.42045063,-0.21694079,0.42544493,-0.28611490,0.46936631,-0.05129756,0.03201176,
    0.36987498,-0.11170305,0.30052003,0.56808305,-0.37023267,0.53011829,0.21021207,0.03998959,-0.21883015,-0.38727099,-0.48274779,0.03002898,-0.25583535,0.56133687,0.02154613,0.07979036,-0.30404964,-0.01136070,0.48403424,-0.34081632,0.23214328,-0.21892659,0.34675661,-0.58738041,0.07048234,0.43152842,-0.03519600,-0.02558790,
    0.51457858,0.81999552,-0.32557565,-0.10416849,0.34320900,-0.25871497,0.42600274,-0.18959400,-0.39250052,-0.05587998,0.21142939,0.64138961,0.27030644,-0.14888448,0.31847087,0.48354903,-0.48933810,-0.10373520,0.09822588,0.31215900,-0.56764585,-0.22469942,0.16128626,-0.18908857,0.11892762,0.30052975,-0.13754630,0.12219194,
    -0.09075987,0.10723142,0.34729716,-0.05256926,0.53403187,-0.15186767,-0.30199042,-0.24520117,0.53513056,0.66743892,-0.05716243,-0.37222111,0.35334677,0.00925077,0.19958302,-0.49142686,0.66188025,-0.40182781,-0.59583300,0.58916986,-0.40216172,0.11517667,0.14604716,-0.01192557,-0.50242072,-0.33158073,-0.55569530,-0.04401736,
    0.41553316,0.56765729,-0.21480955,-0.41052574,0.24844852,-0.37889123,0.15587544,-0.29242992,0.08340178,-0.08987370,-0.14244904,0.33982098,-0.26070637,-0.45139569,0.11193150,0.13642225,0.28540382,-0.52045095,-0.20964321,0.50561029,-0.47197011,-0.49290621,-0.32099989,0.11989610,0.03823181,0.04001142,-0.25562677,0.37088820,
    -0.14582872,-0.04825635,-0.42680126,-0.17886582,0.18188065,0.05884716,-0.01822434,-0.12098403,-0.47803894,0.32331374,0.17621917,0.19598550,-0.10877258,0.78561515,-0.14734328,0.00176081,-0.52489156,0.12835884,-0.44400159,-0.40600455,0.07646359,-0.18851085,0.51714325,-0.70523232,0.54180026,-0.41857734,0.42815080,-1.05852640,
    0.03315192,-0.01291815,0.05128042,0.00403963,-0.05518879,0.08197303,-0.03965420,-0.09742385,-0.08445349,-0.01409037,-0.20129617,0.33570156,0.23611890,0.24758968,-0.04436009,-0.25663581,0.32253265,0.47530171,0.21317752,-0.03379925,-0.25821948,0.18035978,-0.06486345,-0.38608739,0.73302585,0.54127043,0.06016603,-1.35467386,
    0.48787576,0.45784041,-0.39661133,-0.51767147,0.51567298,0.31685862,0.30449149,-0.01633108,-0.01367799,-0.13971402,0.04031884,0.10437873,-0.01332467,0.06136250,-0.12792759,0.63746578,-1.17851770,0.27706802,0.36568996,0.29243740,0.13099599,-0.01611189,0.22438239,-0.09167057,-0.46771353,-0.18645370,0.67061812,0.53870928,
    -0.08713893,-0.02852941,0.29589200,0.80080378,-0.14004618,-0.47867835,0.46414009,-0.14013089,0.20307420,-0.00331327,-0.05448468,0.06369086,0.11182522,-0.57683069,0.36219633,-0.35179004,0.14738224,-0.20030756,0.39255604,0.63079882,0.18883419,0.19767268,-0.00503441,-0.37244707,0.51595044,-0.08432284,-0.29423031,-0.08435890,
    0.15300301,-0.14002752,0.28410161,0.16925655,0.68831581,0.35474977,0.05629849,0.41464138,0.22381264,0.25348952,-0.04841144,0.35305241,-0.13114850,-0.37531158,-0.26644802,0.37835449,-0.48409292,0.06747579,-0.12598407,-0.24389702,-0.57288891,1.10438168,0.30477864,0.44354278,0.17302310,0.07313304,0.43446851,0.52940959,
    0.51538581,0.50179863,0.27664185,-0.34228620,-0.30916625,0.00308619,0.05813689,0.71349263,0.61500221,0.07479856,-0.41755158,-0.33915567,0.30378488,-0.65541399,-0.32407892,-0.23873514,0.49888262,0.29385629,-0.49055436,0.31626382,-0.01362224,-0.39169404,0.18244837,0.43399343,-0.18361472,-0.19013013,-0.19791187,0.68284333,
    -0.17701697,-0.38095355,-0.01378116,0.08250117,-0.30105710,0.20733339,-0.28177574,0.14242725,-0.13205370,0.01242740,-0.92958486,0.36130062,0.20222947,-0.93231827,0.57559079,0.39245698,0.09441474,-0.08603641,-0.17376879,0.43172333,0.03360504,0.34444085,-0.63763082,0.31905311,0.02240780,0.03195283,-0.29082140,0.34632263,
    0.08187637,-0.17848204,0.11641099,0.17526379,0.48697683,0.02263459,-0.25528336,-0.03412418,0.03352227,0.65253234,0.21859755,-0.03147765,0.26101604,-0.41610813,-0.30700299,0.29517305,-0.23461774,0.07962298,0.17017682,-0.21285033,-0.70195919,0.61565799,0.02136532,0.37979710,-0.13826676,-0.38085842,-0.18223003,0.21051720,
    0.54061842,-0.79597789,0.21630083,0.06405894,-0.63644600,-0.10055976,-0.33077085,-0.23552006,-0.00854374,0.27486944,0.22327128,-0.05072344,-0.22257702,0.61273903,0.30443168,-0.15944551,-0.22758083,0.22965752,0.10609000,-0.33884388,-0.05164163,-0.09846498,0.21812136,0.08249540,0.22080654,-0.09060447,-0.76044571,-0.86742365,
    -1.16717660,-0.15500271,-0.33629927,0.60249841,0.07007597,-0.07139089,0.32566553,-0.31976029,-0.49460986,0.58226031,0.69266373,0.12665096,-0.14570080,0.00963325,0.26647401,-0.29918572,0.19346550,-0.12212081,0.20302145,-0.32186514,-0.34832084,-0.13546610,-0.09576020,-0.65566337,0.16998215,0.28892681,0.13824709,0.27108645,
    0.02893888,-0.30510029,0.65294719,0.54752392,-0.21418291,-0.74809504,-0.57673675,-0.17346507,0.78654033,0.65946943,0.03343794,0.32441455,-0.07787973,0.61088175,0.41889438,-0.25039530,0.09291803,0.19195491,-0.34595293,-0.10426216,0.16220008,0.49170664,0.59077173,0.62368596,0.45975685,-0.43238670,-0.49283692,0.18060856,
    0.47028333,0.11740254,0.29386914,-0.37152407,-0.31055066,0.20526107,-0.42106813,-0.34379441,0.08962540,0.20125403,-0.40437657,0.21848910,0.16395225,0.06596214,0.35872683,-0.04933681,0.21491098,-0.21618518,0.13562617,0.19565941,0.10126644,-0.63789922,0.18670119,-0.27863914,-0.16218740,-0.14380676,-0.13427003,-0.74152583,
    0.58719349,-0.15704522,-0.33948001,-0.78696865,-0.32420784,-0.79885036,0.14052548,-0.09826408,-0.03753095,0.00325362,-0.07773255,0.42567816,-0.43372679,-0.03286819,0.51564437,-0.00454332,-0.46997544,-0.02875182,-0.71010536,-0.07169695,0.41183779,0.40140948,0.06965130,0.08662017,0.61491168,-0.88582152,-0.36968151,-0.24517862,
    0.28934836,0.06555353,-0.16202702,-0.18656594,0.00577927,-0.31667504,-0.50784004,-0.19288175,-0.17139141,0.30078170,0.78078711,0.42386305,-0.50038296,1.05109537,0.21154720,-0.35959134,-0.28848046,-0.68431777,-0.00593694,-0.41417575,0.20480940,-0.07497864,0.26006258,0.02930917,-0.18661454,-0.06177027,0.01014400,-0.59321266,
    -0.41420433,0.32819459,0.12398774,-0.12586541,0.06086744,0.38276476,-0.34223700,0.33576992,-0.01737676,-0.20916677,0.40338308,-0.06185894,-0.64582723,0.14777058,-0.67714059,0.63883293,0.23876913,-0.52640891,0.09416424,0.17527039,0.10298650,0.09170977,0.35851350,-0.53024304,-0.43230161,0.64582735,-0.04931367,0.01690889,
    0.20764200,0.02677195,-0.55353218,-0.05127086,-0.31469432,-0.14324111,-0.18232609,-0.14714400,-0.44475836,-0.64292365,0.39243263,-0.33304036,-0.45225650,0.19963217,0.21284887,0.15191862,-0.00833167,0.15004452,-0.25464785,-0.37029833,0.13007054,-0.12421016,0.15159434,0.11543518,0.62735337,-0.15525727,0.20788765,-0.35765350,
    -0.37766308,-0.19301601,-0.52215403,-0.59625250,0.26142156,0.09804668,-0.19433708,-0.22274503,-0.37667978,0.31157613,0.28231058,0.56610572,-0.42798787,-0.27087387,0.08584368,-0.04982449,0.03183698,0.14979683,-0.36439687,-0.05008025,-0.53916466,-0.54890531,0.06492110,-0.28905791,-0.16539875,0.11697682,0.18120196,0.30916876,
};
static float l1_bias_array[28] {
    0.18929143,0.13299634,-0.36412942,-0.03207149,-0.02902044,0.10830962,-0.13203722,0.36953276,-0.07162423,-0.13883182,-0.21387012,0.06456999,0.16089758,-0.00958159,0.18258731,-0.46629417,-0.16650914,0.05939745,-0.41868994,0.29453462,0.10616671,0.03908552,0.06879206,-0.02816369,-0.17548645,0.25915805,0.22162826,-0.05039269
};
static float l1_output_array[28];

static matrix_t l1_weights{28,28,l1_weights_array};
static vector_t l1_bias{28,l1_bias_array};
static vector_t l1_output{28,l1_output_array};

/******** Layer 2 ********/
static const float l2_weights_array[784] {
    -0.20136510,0.09438901,0.04664790,-0.38470486,-0.04190647,0.59719872,0.44918108,-0.59822524,0.02259752,-0.37931189,0.36038184,0.62463289,0.01041503,0.28732762,-0.60018301,-0.41307360,-0.32909164,0.67757910,-0.28763887,-0.46973708,-0.07974817,-0.89724386,0.31873697,0.02453482,0.45200476,0.12854029,0.24926940,0.71844220,
    0.80194795,-0.17836136,-0.16328186,0.06461748,0.05965338,-0.23298606,0.07209526,-0.14914052,-0.33029181,-0.49902827,-0.16053583,-0.43799144,0.16058251,-0.42399558,-0.74173480,-0.38790503,-0.30325088,-0.22202335,0.04054078,-0.05172164,0.18173845,-0.49582371,-0.58627677,0.10143578,0.18032771,0.61323053,0.71255177,-0.00631090,
    0.01863220,0.60122693,0.32726276,0.26115194,0.18811609,0.54360527,0.83984739,-0.09345814,0.37055326,0.39289984,-0.13420025,-0.16406707,-0.01379664,0.88311940,-0.62849820,0.87187195,-0.17643182,0.01542405,0.45903316,0.18109156,-0.26510096,0.34809110,0.00764452,0.23224983,-0.00964661,0.23895603,-0.59901649,0.41956195,
    -0.16029923,0.35635236,-0.47721547,0.04305722,-0.43746582,-0.17644088,0.11815297,0.44372120,0.13341641,-0.00842590,0.08792015,0.09516090,0.38460866,0.68091923,0.53216422,-0.16176896,-0.66894567,-0.01383034,-0.52892548,0.20060262,0.62518471,-0.07285678,0.34156570,-0.51853621,-0.01044715,-0.37579840,0.03737684,-0.21101870,
    -0.52931750,0.30488938,0.16540755,0.67077386,-0.29142556,-0.18633647,-0.56058168,-0.18337242,-0.04468324,-0.07087489,-0.18708216,-0.36387038,-0.77250797,-0.02678370,0.03011727,0.11336846,0.97078353,0.28295827,0.08456583,-0.47262299,-0.36531577,0.11963683,-0.28936729,0.04650684,-0.49023592,-0.36499062,-0.20210046,-0.66511852,
    -0.07499697,-0.00981680,-0.05921283,0.34539247,-0.21832301,0.11231675,-0.07555383,-0.55767822,0.26563650,-0.19397305,0.10466276,0.24446805,-0.51100433,0.22386940,-0.16767687,0.11176335,-0.21003623,-0.46951070,0.40483809,0.38660076,0.22900940,0.25954401,0.13748091,0.52519232,0.67319238,-0.60979134,0.04328207,0.51976985,
    -0.28129974,-0.18450718,0.60329014,-0.24277002,-0.50978392,0.06451531,-0.20131633,-0.59954321,0.30135021,0.75777191,-0.35170275,0.12269424,0.49622139,0.07772753,0.16110779,0.83475828,0.00241836,0.35740513,0.26594335,-0.16844034,-0.41115099,0.36886275,0.09947347,-0.01220604,-0.26534051,0.21411940,-0.40593129,-0.19849394,
    0.74901921,-0.34289244,0.34158525,-0.25517872,-0.45688120,0.08910921,0.43129331,0.17486717,-0.15247674,-0.07131439,-0.21001963,0.27307969,0.84907055,-0.35715565,0.16196993,0.28921574,-0.11288898,0.08674389,0.17676973,0.20674931,-0.50838488,0.51254100,0.30639523,-0.02319987,0.03000201,-0.16888937,0.11253664,0.00215049,
    -0.51933980,0.06719972,0.41009799,0.03707908,0.50228029,-0.31254500,0.58414096,-0.08230419,0.78702784,-0.07558253,0.99249101,-0.23799226,-0.41931894,-0.25396898,0.09220024,-0.00943056,-0.37284416,-0.02717168,-0.15496987,0.16187675,-0.20606413,-0.06339877,-0.14435783,0.01071452,0.26025528,0.58366078,0.15883794,0.01611903,
    0.12067946,-0.38757622,-0.33497065,-0.46191314,0.24945384,0.28553787,-0.34610143,0.21867958,-0.08056775,-0.72212994,0.22519723,0.12687373,0.74067289,-0.07711831,-0.06791850,0.19390894,-0.04776387,0.07243974,-0.20584805,-0.15068758,-0.67574608,-0.59189546,0.14097434,0.20925751,-0.17791589,-0.31920621,0.63472319,-0.77723432,
    0.28855923,-0.37744591,0.04549783,-0.11176099,0.49070531,0.49867496,0.00121660,0.29567918,0.41103473,-0.15052372,-0.28380954,-0.09193197,0.01911677,0.72706759,-0.07111575,0.32034996,-0.47707388,-0.72604513,-0.24125582,-0.46981567,0.35538787,0.42672157,-0.41691974,0.05184837,0.45092598,0.77960801,-0.11901856,-0.16819368,
    -0.51658022,-0.24288923,0.09742887,-0.12514572,-0.69337255,0.48505107,0.17070876,0.36222309,0.01130331,-0.12816747,-0.25673845,-0.40634319,0.59031719,0.02389435,-0.00106873,-0.23105775,-0.28677416,0.56642324,-0.46820503,-0.26852039,0.27583143,-0.90182215,-0.03309702,-0.71564353,-0.07347083,-0.15708035,-0.30536830,0.53221619,
    -0.07559458,-0.45969677,0.50225586,-0.50432163,-0.01040074,-0.19572632,0.50181127,-0.32733282,0.91311920,-0.60320580,-0.48197797,0.47393537,0.32798895,0.45651346,0.04817127,0.69431555,0.10062797,-0.15257065,0.06081515,-0.14849780,-0.08439242,0.03243436,-0.26537120,0.76105827,0.11599542,-0.59816444,-0.12865709,0.19866210,
    0.00236449,-0.32374677,0.10443767,0.57729042,-0.18189764,0.35401374,-0.26294518,-0.66322505,0.22009915,0.19477774,0.10705818,0.13449393,0.24835460,-0.51196992,-0.50056547,-0.27167863,0.12308066,0.22252315,0.36131343,-0.67914516,0.29294974,-0.55388534,0.15453473,-0.82915097,0.46328509,0.20981893,-0.12782210,0.21953098,
    -0.14170125,0.32942423,-0.35954335,-0.49881271,-0.25752154,0.36841789,0.30514154,0.53879017,0.28096303,-0.89626032,0.16730538,0.44334581,0.29038143,0.42489916,-0.61625195,-0.10813996,0.16474095,-0.32615915,-0.82934874,0.31357679,-0.79448688,-1.00400639,0.26511601,0.38152400,-0.11933543,-0.00979162,0.36170635,-0.03435024,
    -0.76330560,-0.24253571,0.59479332,-0.39071473,-0.20351852,-0.02857287,0.22321171,-0.06890098,0.76693225,-0.34090129,0.18469898,0.74167609,0.26711467,0.34988210,-0.13259298,-0.21690033,0.32979104,-0.08068684,0.04036481,-0.33562377,-0.32651392,-0.03837770,0.13317387,0.51464397,-0.11684477,0.07320853,0.22706807,0.00586526,
    0.50301081,-0.35281593,0.59878308,-0.43381971,-0.39932904,0.52807057,0.28067639,-0.01426510,0.16435847,-0.32455066,0.08279905,-0.15487966,-0.32631299,0.79257458,-0.62965930,0.24849337,-0.47591680,-0.26569018,-0.43303406,-0.46346250,0.03110449,-0.13111852,-0.15496714,0.24260911,-0.44344941,-0.05768276,-0.08877406,0.65310091,
    0.17529970,0.59855491,-0.65764886,-0.11155713,0.20033903,0.15022460,-0.36639655,0.28554326,-0.33232149,0.26662210,0.04964244,0.44753554,0.31642261,-0.25718394,0.10287671,-0.57608128,-0.28380108,-0.63729745,-0.19207272,0.32514802,0.24924105,0.18908463,0.81394964,0.42697436,0.81466693,0.45552525,-0.18681945,-0.08351149,
    -0.27134645,0.52673382,-0.37775549,0.37173375,0.00774853,0.32485700,0.70125103,-0.31399328,-0.19761394,0.24531661,0.29379648,0.03909053,0.15806510,-0.53527761,-0.19900697,-0.43043411,-0.70141315,-0.18609244,0.39112833,0.16336727,0.43373656,0.54143804,0.14552097,0.17489763,0.37928700,-0.17765602,-0.15500326,-0.25663596,
    -0.15388983,-0.07525302,0.35602504,0.85861194,-0.54938823,0.21276791,-0.32416213,-0.55078125,-0.48354581,0.87121665,0.46434551,-1.13931727,-0.50802070,0.09361365,-0.22543347,-0.27224395,-0.29274225,-0.79011577,0.24459654,-0.04085282,-0.04852669,0.22932158,0.00969398,0.36248931,0.19704996,-0.34609577,-0.29869661,0.20382939,
    -0.34564659,0.68379140,-0.39101025,-0.38203716,0.40464178,-0.36558494,0.34343529,0.16309547,-0.56103247,-0.49687415,-0.44847530,-0.01003957,-0.34063685,0.06773330,-0.55205059,0.20214532,0.40349913,0.83216882,0.19778353,-0.52833259,-0.44632867,0.20878440,-0.06430048,-0.34433153,0.22157058,0.08487891,-0.21669000,-0.10372578,
    0.22174859,-0.19347954,0.16729864,-0.30988568,0.56165069,-0.51798284,0.35369122,-0.15846458,-0.00670367,-0.32774168,0.30118412,-0.51747507,-0.14930177,0.07511317,0.28132328,-0.00571494,-0.00698279,0.45662558,-0.06315555,0.26707041,-0.31543878,-0.25690693,-0.37031457,-0.06154284,-0.25667241,0.27881452,-0.09056243,-0.67534852,
    0.12120868,0.29589349,-0.24631988,0.69740731,0.10320255,0.00634569,0.79600018,-0.05407811,0.19953690,0.55897516,0.41356623,-0.89551556,-0.36266643,-0.11817753,-0.38666210,-0.33707970,0.40038109,0.07013033,0.42795163,-0.19838811,0.46129331,0.26429978,0.21279168,-0.30491996,0.06841419,0.30659488,-0.89601308,0.39549896,
    0.26239550,0.18590541,0.02288456,-0.14468087,0.17948233,-0.41916370,-0.34703675,0.01724831,-0.47233281,0.17342477,-0.40177354,0.19621107,0.45483866,-0.35763606,0.36319554,0.54237580,-0.26827714,-0.32660267,0.28775674,0.50840789,-0.06205358,0.97894305,-0.39076242,-0.21276496,0.38137615,-0.15387395,0.08196045,-0.08415022,
    0.17061862,-0.02557464,0.51003397,0.31392017,-0.52992105,0.87766653,-0.49581409,-0.12593104,-0.64780205,-0.53168446,-0.53316796,-0.20533301,-0.15424979,0.30871969,0.03550309,-0.17411539,0.49076140,-0.03950715,-0.33170733,-0.22119324,0.41566229,-0.17959917,-0.55973303,0.38529384,-0.52589679,-0.46281371,0.48369527,0.54107076,
    -0.40064350,-0.39688408,0.04835010,0.22239137,-0.58366042,0.26651677,-0.05345955,-0.77794611,0.10403997,0.59015024,0.51100183,-0.04071692,-0.05011091,-0.31397045,0.22216469,0.07608908,0.05028380,0.26594278,-0.07191259,-0.54710358,0.35911229,0.64773989,-0.39371938,0.25177175,-0.45784226,-0.56690991,-0.12968315,0.46428341,
    0.19433224,-0.46032184,-0.13453773,0.06654442,-0.83380473,0.20089954,-0.09300715,0.20763615,-0.60884136,0.79609221,-0.48247239,0.13108429,0.58767951,0.04011767,0.19238609,0.55749255,0.37276217,0.21098733,-0.57560253,-0.49449703,-0.06177667,-0.21172377,0.24243890,0.11555089,-0.70826137,-0.18113679,-0.45243526,0.16469884,
    -0.39133862,0.47188905,-0.42622417,0.70074433,-0.37433630,-0.21236967,-0.57153296,0.15378486,-0.23208481,0.19051255,-0.11020673,-0.07397418,-0.51380956,0.58163685,-0.07176673,-0.20856328,0.05293439,-0.17392653,-0.17369241,0.05886070,0.03785710,-0.05157128,0.38957837,-0.39247957,0.42863500,0.69405437,-0.09816064,-0.37957692,
};
static float l2_bias_array[28] {
    0.07644047,0.25571361,-0.19454676,0.43066004,-0.10146925,-0.21564744,-0.38769844,-0.05395577,-0.21284327,0.34139910,0.10475150,0.11444197,-0.49615020,-0.05407904,0.23013751,-0.43124560,0.05458420,0.08382113,0.08288820,-0.24553384,-0.04148782,0.22701141,-0.15848252,0.09081851,-0.01590706,-0.33775157,0.01490440,0.36901855
};
static float l2_output_array[28];

static matrix_t l2_weights{28,28,l2_weights_array};
static vector_t l2_bias{28,l2_bias_array};
static vector_t l2_output{28,l2_output_array};

/******** Layer 3 ********/
static const float l3_weights_array[784] {
    -0.25430882,0.19213492,-0.68999302,0.01432798,-0.02629210,-0.52011544,-1.00013149,-0.11885412,-0.08097817,0.19567706,-0.23652194,-0.46351704,-0.29820997,0.08373939,0.01488372,-0.41366142,-0.05006704,-0.28780860,-0.42530778,-0.47951278,0.83000779,0.40380776,-0.75890470,0.46643850,0.28148422,-0.19003065,-0.36513749,-0.12511143,
    -0.16444984,-0.27241200,-0.03691418,0.59097713,0.00582210,-0.44223922,0.04033017,-0.36610541,-0.49034348,-0.05802563,-0.66918945,0.79120421,-0.36089712,0.18433309,-0.12021831,0.13106397,-0.25316298,-0.43999228,-0.77380663,-0.21600537,0.54071820,0.21679419,-0.27041554,0.38290825,-0.32241705,-0.37523025,-0.29802358,0.37491676,
    -0.18048315,-0.50844866,0.67882103,0.50658679,-0.45653078,0.41380656,0.55284578,0.20228328,-0.16485147,-0.40726432,0.41932479,0.02180772,-0.00704756,-0.05597052,-0.65300655,-0.32288456,-0.10935737,-0.08479211,0.67981690,-0.08212385,-0.59582251,0.15436475,0.29526675,-0.11239598,0.45289609,0.10614460,-0.32315645,0.21734671,
    0.91508543,0.03846528,0.09366944,0.38122195,0.19199435,0.18639337,-0.20347773,-0.40241018,0.30575490,-0.28427964,-0.09440322,0.34536555,-0.30308560,0.30120343,0.33576062,-0.49309233,0.05004496,-0.02848693,-0.04163805,-0.13220155,0.45583817,0.17336728,-0.49049634,0.25290772,-0.48303109,0.20562619,-0.61374617,0.69269061,
    -0.54351634,-0.66807270,0.48870742,-0.18248956,-0.10779726,-0.22723010,0.29176635,0.32554027,0.23061201,0.20073627,-0.31305292,-0.20707123,0.36182860,-0.29853669,0.38138500,0.28316268,0.10720406,0.11739168,-0.02431980,0.87528014,-0.61644316,0.77002072,-0.25207868,-0.08846995,-0.14559560,-0.04620841,-0.15202188,-0.17955369,
    0.75550550,0.22822748,0.34771615,-0.11287787,-0.57844359,0.22381483,0.36321956,0.05852855,-0.11264034,0.11139245,0.54838556,-0.23434904,0.55761421,-0.01781866,0.71900684,0.51502609,0.96687222,-0.31659946,-0.32580972,-0.28262734,-0.52150846,0.15079343,-0.13068590,-0.02577927,0.29375613,0.17813267,0.40040940,0.18230100,
    0.26491955,-0.28205398,-0.12625985,0.69115496,-0.12680566,-0.79067504,-0.13387573,-0.33419293,0.40146384,-0.45336264,0.19831809,0.54110652,0.39424992,-0.36234871,0.30173209,0.25384170,-0.24095884,-0.03415488,-0.26965788,0.42298213,-0.10370037,0.65280813,0.28705731,0.13109320,-0.11266843,-0.34457728,0.22976416,0.38107291,
    -0.30036572,-0.60046655,-0.00996859,-0.11649536,-0.08669210,0.39967778,0.09493805,0.24385099,0.56904238,-0.16983490,-0.56277865,-0.13637796,0.46656305,0.47018600,0.06560505,0.43842843,0.21075030,0.09847308,0.27660879,0.15334742,0.08515336,-0.28375122,-0.21864438,-0.18592517,0.18419854,-0.35572997,-0.61769831,-0.77612710,
    0.32733494,-0.52115232,0.17054167,-0.73347241,-0.31007722,-0.01914074,0.68683493,-0.27443361,0.07103717,0.15873975,-0.28481984,0.07605164,0.49088410,0.78494400,-0.18671444,0.60380608,-0.02556741,-0.84984726,-0.30298460,0.13120586,0.43949604,0.63999534,0.84529734,-0.47517803,-0.72944796,-0.00473247,-0.35610723,-0.28350359,
    0.42374584,-0.05081144,-0.15494844,-0.45796493,0.22542574,0.20706710,0.37661245,-0.32140881,0.15717193,0.01642116,0.31234613,-0.17127456,-0.41514289,0.17772913,-0.58491492,0.00408985,0.15328100,-0.33653063,0.15841752,-0.12899478,0.20031877,0.19900070,-0.23178039,0.65466785,-0.04359020,0.63766599,-0.41817087,-0.30873325,
    0.20778586,-0.50293422,0.78542966,0.12891151,0.30805999,0.19758400,1.04271865,0.03990567,-0.07296568,-0.33925384,-0.58681667,0.27650461,-0.44835311,0.35572100,-0.00234610,-0.19120888,-0.36875400,-0.47151709,-0.03675492,-0.21082579,0.25525942,-0.27988869,0.36273637,0.02189083,-0.40788227,0.17104244,0.35668087,-0.51507545,
    0.44745857,-0.48827425,-0.09650380,0.23519674,0.24884976,-0.17534427,-0.23183049,-0.35817221,-0.07179417,-0.36137328,0.13333966,0.89217466,0.28952292,0.11894972,-0.28928357,0.76704937,0.58076048,0.02764725,-0.52091503,-0.08199451,-0.27693060,-0.25416175,-0.03152335,-0.47205323,-0.22786430,-0.18994857,0.35435599,0.42375872,
    -0.44583410,-0.21964346,0.41704142,-0.26820391,-0.24597117,0.05070437,-0.34092143,-0.26906195,-0.57765585,-0.35900447,-0.20455480,0.00201815,0.31063667,-0.08940255,-0.58127600,-0.13367814,-0.16806054,-0.30919197,0.01615074,0.51383215,0.15696923,0.12272277,0.28896976,0.30591124,0.70335740,0.40802941,-0.13512678,-0.26311630,
    -0.47929356,-0.34158024,0.17743245,0.01840892,-0.06845085,-0.16957606,-0.15103556,0.11537611,0.02193099,-0.61401647,0.20073693,-0.50826526,0.07366656,-0.10946800,-1.12300158,-0.23992990,-0.37905267,-0.38104531,0.42011634,0.04114563,-0.49459913,0.20305637,0.59962702,0.36926097,0.06328364,0.04154315,-0.03805726,0.12089320,
    0.26824364,-0.37459379,0.07895948,-0.06174460,-0.28820544,0.28169453,-0.18700615,0.81165224,-0.32960200,0.12938970,0.37812656,-0.16137430,-0.34420627,-0.36584720,0.34864557,0.16272670,0.15659595,0.00598051,0.20822133,-0.67186719,-0.66831046,-0.24152589,-0.59678274,0.54602355,-0.55362213,-0.64532083,0.11540505,-0.08836393,
    -0.70840174,-0.08363235,-0.55931735,0.19806518,0.21671483,-0.21486333,0.25080410,0.28831053,0.01193302,-0.17003028,-0.18555760,-0.17800915,-0.14161949,-0.29187819,-0.28330484,-0.03636044,0.22032154,-0.06960746,-0.01788438,0.49161133,-0.53488827,0.29775405,0.80737889,-0.18868345,-0.09172043,0.14110327,0.47998470,-0.69035441,
    -0.15134069,0.43165055,0.16643818,-0.73507398,-0.36203203,0.45977071,0.41477382,0.54936951,-0.25341949,-0.07043992,0.78957111,-0.77364671,-0.16392505,0.01241536,0.21160004,0.22078262,0.04123170,0.26047784,0.21145663,-0.19656363,-0.35039791,-0.45159334,0.37545604,0.42800826,0.09466364,-0.16445242,0.11926498,0.05960868,
    0.23260061,0.28218189,0.50929928,-0.36443618,-0.11756749,0.44275168,0.25234687,-0.31230786,-0.14134686,-0.54897702,0.51135659,-0.23097008,-0.21473473,-0.06203508,-0.07829823,0.10531661,0.33240405,0.54254705,0.16724676,0.76279163,0.51479739,-0.31819853,0.48911542,0.15831704,-0.36203891,-0.09018998,0.10333873,-0.20116571,
    0.36900407,0.09881774,-0.38290185,0.24826810,-0.91962785,-0.48916966,-0.08669867,0.65429437,-0.38446978,-0.02074683,0.38601309,-0.21469487,-0.31691429,0.41230792,0.72072870,0.34447390,0.11818640,0.39862648,0.03007028,-0.45868462,-0.40929624,-0.01441052,0.73260146,-0.42377773,-0.24613200,-0.11082631,-0.91920877,-0.42015857,
    0.19303647,0.19288611,0.10083431,0.50767118,-0.20822477,0.13385457,0.44652951,0.19510697,-0.55737025,0.15528768,0.30873111,-0.21252072,-0.61376762,-0.48167902,0.62711775,-0.52021539,0.16521007,0.23930940,0.32967225,-0.70393091,0.04187729,-0.55192184,-0.13183092,0.24517167,0.65447056,0.31978196,0.95096087,-0.04992990,
    -0.16250010,0.09884138,-0.63667226,-0.06557601,-0.25469923,-0.07450783,0.01180863,0.31491372,-0.47233719,0.02161397,-0.15604211,0.53889155,0.54512870,0.78356409,-0.69775385,0.33950466,0.02965691,-0.28945762,-0.13452061,0.45384687,-0.01488627,-0.50544113,0.21889254,-0.62494344,0.35126826,0.28898251,1.07380581,-0.49028289,
    -0.15358891,-0.46041876,0.07735299,0.26667684,-0.59273034,-0.45419252,0.80104470,0.30404922,-0.32742816,-0.37122512,0.14991307,-0.03866655,0.75095117,0.01345974,-0.10309372,-0.18838508,0.26931027,-0.01269103,-0.17571439,0.62527132,-0.56754386,0.23990797,-0.00799367,0.13991429,0.09850574,0.67328429,0.48404142,-0.38158417,
    0.23675984,0.01627365,0.40245736,-0.45200798,-0.30325606,-0.39792573,0.09318331,0.20217513,-0.02604815,0.43467268,0.46410000,0.56200826,-0.02155029,0.24847060,-0.02000637,-0.06838173,1.13411319,-0.53681183,-0.49073443,-0.29043946,0.22894718,-0.15892132,0.25171727,0.07938336,0.27094239,-0.57898003,-0.23692752,-0.28400910,
    0.23356822,-0.25271153,-0.16259012,-0.29833919,0.06947836,0.62732190,0.46150926,-0.01207490,0.10658680,-0.35928932,-0.14168464,-0.27971843,-0.12234446,0.73425192,0.03312998,0.23484345,-0.49914432,-0.49409851,0.10966897,-0.27581024,-0.39306781,-0.38039792,-0.37680462,0.43631643,0.24478094,0.73378867,0.09642131,-0.14634109,
    -0.32772753,-0.52843690,-0.17699251,0.32559055,0.35835293,0.45999271,0.29437637,-0.25011671,-0.33611488,0.53557521,-0.35349613,0.06539343,-0.11509079,-0.67292702,0.14717372,-0.21929960,-0.35802299,0.00825137,0.07294437,-0.46923944,0.72257793,-0.20244476,-0.40417373,0.29668942,0.19715931,-0.08540778,0.37389871,0.44704488,
    0.28974530,0.47323269,-0.16251621,-0.07021705,0.18653658,-0.30847174,0.03690755,0.51832044,0.30379921,-0.37059298,-0.00022297,-0.29593742,0.02294860,-0.40622643,0.52570021,0.65784770,0.20838939,-0.07365240,-0.39022422,0.64327574,-0.72369921,0.43269354,0.40652791,-0.21315868,0.80030668,-0.12804069,-0.39892483,-0.09187716,
    -0.31711817,-0.15005891,0.72461128,-0.38557935,0.67908412,0.73987406,0.64584804,-0.22239822,-0.57465279,-0.52938324,-0.03471640,-0.18426597,0.48553225,0.23118922,-0.64472002,0.24979256,-0.13486964,-0.60850620,-0.00117348,0.21644612,0.38665217,-0.15795214,-0.06923227,-0.40378538,0.13572180,0.65567899,0.37132555,-0.25569245,
    -0.68384421,-0.64393318,0.02253992,0.04253644,0.29264316,-0.07179774,0.31857380,0.08466844,-0.73834902,-0.25717551,-0.14115000,0.23547646,0.89781660,0.20114252,-0.11115111,0.18881130,0.29453856,0.07502708,-0.22055830,0.70795363,-0.03269872,-0.67773396,-0.09235450,-0.22533856,0.52416724,0.38714436,0.23630373,0.03424770,
};
static float l3_bias_array[28] {
    0.11891372,-0.09592015,-0.27210963,0.35297349,0.11702899,0.30964538,0.18963896,-0.83352679,-0.62642753,-0.22476038,-0.17260231,-0.01849595,-0.05926803,0.13717535,0.14897285,0.05469957,0.11170188,-0.37878272,-0.00137879,0.21886583,-0.29342142,0.06720599,-0.02228746,-0.54384565,-0.22478585,-0.16403353,-0.75489044,-0.44153926
};
static float l3_output_array[28];

static matrix_t l3_weights{28,28,l3_weights_array};
static vector_t l3_bias{28,l3_bias_array};
static vector_t l3_output{28,l3_output_array};

/******** Layer 4 ********/
static const float l4_weights_array[784] {
    -0.08473210,-0.00947908,0.22878903,-0.41830575,0.29442039,-0.04741786,0.74892467,-0.30820948,0.13138488,-0.57742423,0.12779257,-0.16134486,0.06998088,0.48212501,-0.34438446,0.37721181,-0.04720106,-0.76237386,0.30022115,0.26700118,0.11611348,-0.09775024,-0.11252994,-0.06732621,0.40720221,0.37134615,-0.02082693,-0.03868937,
    0.06547979,0.40338773,0.40600088,0.42508474,-0.10787643,0.12058057,-0.33349845,0.02662731,-0.15056582,0.40114012,0.02788066,-0.14445321,-0.04033206,0.18111481,0.48846310,-0.24693127,0.31555131,0.00844251,0.11927811,0.08756892,-0.42254487,-0.18566400,0.33445626,-0.20305271,0.55065376,-0.52138323,0.11127318,0.10977296,
    0.34650037,0.22655961,-0.17294298,0.30602968,0.35635710,-0.10642166,0.02739644,-0.43302584,0.18143073,0.05028190,0.03559290,-0.04457426,-0.05220296,-0.37645045,0.70753020,-0.73419362,0.23802623,-1.31570625,0.43856311,-0.92245454,-0.25691471,-0.44608989,-0.22006175,-0.01230558,0.02131064,-0.23435085,-0.23746033,-0.56828940,
    0.26862815,-0.28708822,0.09924264,0.39764103,-0.16845207,0.02737294,-0.84474140,0.15106444,-0.03651580,0.95186007,-0.01381246,-0.26655775,0.38190779,0.11564779,0.67968363,-0.28291950,0.18029056,0.12163794,-0.27284423,0.13839190,-0.14853916,-0.44005239,0.28330591,-0.44857925,0.05120201,-0.58622563,0.12636678,-0.92460763,
    -0.02877262,0.79041737,0.03645002,0.40754676,-0.05167693,-0.50291550,-0.03018752,0.07883932,0.49367368,0.26824042,0.18800016,-0.25026160,-0.20255473,-0.06603131,0.14595214,-0.37707791,0.06844852,-0.31211427,0.62480694,0.49599990,-0.05569588,-0.61440301,0.24539971,0.37211773,0.14020523,0.05044777,0.62090880,0.00534721,
    -0.91122168,-0.17519146,1.08214200,0.11728151,0.08682331,0.27201691,-0.68093288,-0.22822307,0.41043398,0.50272781,0.12128145,-0.18781301,-0.29150426,-0.01501277,0.45331496,0.03272376,0.45601460,0.31403613,-0.09176954,0.81144887,0.27851361,0.70199430,0.27980649,1.04474139,0.26791283,-0.04744120,0.17671342,0.08860867,
    0.27819625,0.47669682,-0.63275659,0.35346434,-0.72905016,-0.23889291,0.18076263,-0.00686545,-0.10259992,-0.39276662,0.11521336,0.07486782,-0.05090806,-0.71563041,-0.55822420,-0.33277291,-0.62722933,-0.04494751,-0.80943549,-0.81815535,-0.04164623,-0.69657421,-0.52866125,0.41638324,-0.14262448,-0.12650682,0.09250107,-0.02801275,
    -0.34861568,0.65051913,-0.25435004,-0.25731853,-0.03103478,0.53412366,0.45781973,0.20290889,0.21791431,-0.28419325,0.21793181,-0.22417358,-0.26899338,-0.11600398,-0.21944347,-0.32975101,-0.14312159,-0.31378955,-0.42379549,0.01088968,-0.19869506,0.25216559,0.14622833,-0.14178661,-0.55402887,0.56490815,0.46825635,-0.05448269,
    0.65784347,0.62335372,-1.17048550,0.91264313,-0.62777925,-0.45597106,0.30969185,-0.16870473,-0.37695527,-0.03649671,-0.46928918,0.08580990,-0.00797292,-0.43970135,-0.16300899,-0.13387972,-0.69697666,-0.62314278,-0.39402571,-0.60920006,-0.31941095,-0.88978463,-0.54330397,0.48147219,0.07968326,-0.42246959,0.08674905,0.05142653,
    -0.23053527,0.04906715,0.44288474,-0.38784099,-0.31489706,0.03177453,-0.09896910,0.55351329,-0.35626596,-0.34140342,0.39758775,0.92283368,0.59097034,-0.04970000,-0.55978811,0.39772737,-0.10916413,0.25196740,-0.62654573,-0.07390743,0.57512075,-0.32824385,0.14804912,0.20534971,-0.47854188,-0.29142526,0.26178330,-0.03867901,
    -0.37798956,0.01955824,-0.13576607,0.07836655,0.05033086,-0.44893226,-0.07805946,-0.64021456,0.06724341,-0.18343934,-0.26599717,-0.05030253,0.01809340,0.10731192,-0.26851436,0.27787530,-0.21799879,-0.27562109,0.13087393,0.18131973,0.43398458,0.08007829,-0.28104976,-0.46195853,0.42321101,0.33770162,-0.10976614,0.05243590,
    0.07706349,0.13838626,0.24292217,0.06537575,-0.38663954,-0.00131645,0.27788386,-0.57314932,0.20026019,-0.57497001,-0.56967932,-0.07165528,0.03391543,0.17806144,-0.23563188,0.21356192,0.08857839,0.11027763,-0.37561429,0.12610959,0.05436402,0.05859870,-0.10605814,-0.91715926,0.18341251,0.01907117,-0.63580632,-0.51429564,
    -0.07236081,0.32316130,-0.76195574,0.48563913,-0.04897826,-0.32328048,0.74978578,-0.26928359,-0.30484122,-0.05799240,0.52207178,-0.08443825,-0.41730148,-0.11999112,-0.14469343,0.35402897,-0.68204319,0.10515933,-0.06027512,-0.08196744,-0.46460494,-0.18197091,-0.80628455,-0.04033404,0.24458383,-0.53209656,-0.14049557,-0.15256980,
    -0.23683147,0.19575433,0.34183043,0.50228781,0.75059795,-0.41339618,-0.77529448,0.22847822,0.25974065,-0.14155973,0.32871541,-0.60834122,0.09335292,0.62298101,0.14716889,0.16591638,-0.29000223,0.08647227,0.05651867,0.09813824,-0.36641058,0.14375734,-0.13168813,0.58660835,0.25005880,-0.23046562,0.23837253,0.08212634,
    0.01560855,-0.14225031,-0.06698813,0.56585962,-0.10815108,0.57076383,-0.45865509,-0.06214416,-0.34239188,0.07523777,0.24761048,0.47783345,0.20287369,-0.31988573,0.50984526,-0.75703579,0.32820538,-0.77078545,-0.04525150,-0.44568154,-0.15169871,-0.03067928,0.01700607,0.35084087,-0.08815397,0.46172485,-0.21075097,-0.12269907,
    0.26001823,0.10529377,-0.20813406,-0.06722439,-0.21018761,0.49903479,0.67925042,-0.59153593,-0.49595994,-0.34890458,0.05720273,0.23500153,0.12839960,-0.37351367,0.30280304,-0.18551090,0.12444879,-0.11458256,0.14480783,0.33666271,0.02965284,0.18415023,0.11059950,-0.14974065,-0.28957662,-0.36606517,-0.37952250,-0.34493044,
    -0.42852700,0.08272454,0.93288976,-0.25417015,-0.45039272,-0.53048587,-0.15259938,0.28972909,-0.79600132,-0.43763468,0.50091290,0.32619187,0.38862598,0.59612644,-0.49163529,0.69112343,-0.02786053,0.31518880,-0.52699620,0.19424674,-0.02099149,-0.03445527,-0.23798032,0.13593107,0.30160624,-0.28596213,0.26861888,-0.23762476,
    -0.07176374,-0.03783394,0.31423166,-0.08587976,0.46189758,-0.20298404,-0.04426212,0.55010134,-0.26736864,0.00349935,-0.40309066,-0.57348770,-0.50301605,-0.50048488,0.11998832,0.02983955,-0.29226270,0.01784281,0.21759005,0.46405488,-0.25883758,-0.16146944,0.30464801,0.32847515,0.26516783,-0.72943783,-0.25484633,-0.70979869,
    0.41614032,-0.20308964,-0.16929863,-0.39468843,-0.97804296,0.16336025,-0.52572936,0.03903496,-0.23341300,0.62601626,0.30141255,0.06819230,0.19957240,-0.10500556,0.35559666,0.46070293,0.67797744,-0.45863995,0.06105139,0.27288970,-0.24279553,-0.01777565,0.20108809,0.49411556,-0.07716367,-0.30273715,0.10907827,-0.06036446,
    -0.27256429,-0.09329572,0.60574883,0.55787212,-0.33248660,0.00473472,0.20391957,-0.00803092,0.84859842,0.25532693,-0.37360552,-0.40627682,-0.71761268,-0.15436594,-0.27991313,-0.05052827,-0.03866432,0.66776973,-0.48295873,0.83987945,-0.22687668,-0.40013009,0.59887415,-0.24865240,0.22472525,-0.02184775,-0.31177220,-1.09677315,
    0.37122646,0.79314351,0.25963947,0.18172324,-0.33085087,0.08970746,0.03979434,0.07148559,-0.24496759,-0.42768794,0.31886545,0.66969526,0.45925489,0.00880463,0.32851574,0.13657901,-0.68408686,-1.06487691,-0.49791506,-0.42247432,-0.41816962,-0.13088042,0.63972336,-0.49811512,-0.29362658,-0.33408329,0.12806682,-0.13451974,
    0.41895729,0.53586721,0.06398261,0.07142086,-0.14034624,-0.57555151,-0.23744413,0.00980272,-0.20808989,-0.14030595,0.35976329,-0.50884271,-0.31282458,-0.56157178,-0.18502994,0.05890671,-0.74923956,0.11040998,0.47103089,-0.85951960,-0.39188519,-0.26148000,-0.95622188,0.08094344,0.26493132,-0.50680721,0.17748560,0.26201102,
    -0.20789644,-0.73469096,0.68417621,-0.62526727,0.44750944,0.14565219,-0.02055937,0.05070178,0.62954050,-0.08548130,-0.36955404,-0.51692259,-0.41802058,-0.12483037,-0.60756600,0.12686482,0.61457992,0.62545115,0.99073476,1.16504359,0.16480780,0.51399070,-0.03138911,-0.22042762,-0.39551193,1.21278298,-0.00576252,-0.07116778,
    0.37039676,0.09758101,-0.23661453,0.19653203,-0.23711739,0.48505771,0.09073699,-0.08503690,1.16813838,0.38508800,-0.23147316,-0.19543171,0.14160244,-0.55691504,-0.41665390,-0.64232755,-0.10772503,0.38291162,-0.05025782,0.15280797,0.29366273,0.02035521,0.30465034,0.41767263,0.08044645,0.08868641,0.07189683,-0.03301073,
    -0.18763016,-0.16761731,0.13698404,0.01761828,0.47215226,0.41993275,0.35954568,0.04191108,-0.60701972,-0.06114146,-0.38612208,0.44749764,0.35025766,0.09486231,-0.59584564,0.17603856,-0.33055642,0.26585740,0.44590870,-0.28428683,-0.04931488,0.47897822,-0.45409140,-0.37623712,0.22513965,0.47057700,-0.43712059,0.15981635,
    -0.04155971,-0.59123278,0.88896692,-0.48954821,-0.11379228,-0.24241659,-0.73280561,-0.13546008,0.07798281,-0.19355975,-0.18659323,0.10814955,-0.22782323,0.06811637,0.42466342,-0.01341285,0.68627286,-0.07010688,0.17005517,0.97454470,0.20172101,-0.35298672,-0.15427497,-0.43307871,-0.33085772,0.10521624,-0.14482872,-0.19384347,
    -0.22568554,0.40343091,-0.06924284,-0.13628694,0.00226285,0.21142513,0.64984000,0.04831513,-0.46735364,-0.24007347,-0.09998567,-0.10534269,-0.17087607,-0.31953809,0.31564537,0.10495908,0.20584118,-0.51432055,0.59462357,-0.05740060,0.26617208,-0.61501610,-0.09005423,-1.23657382,-0.51605749,0.30862388,-0.70093709,-0.04066922,
    0.75674027,0.50598961,-0.64813161,0.54229355,-0.63517100,-0.22083983,0.28084934,0.25012624,-0.44130835,-0.17931359,-0.01993124,-0.13142955,-0.00883729,-0.65511310,-0.06816833,-0.18287529,-0.50962186,-0.37942901,-0.46884385,-0.92642385,-0.75427139,-0.87320966,-0.66699147,0.56397063,0.41469339,-0.28899437,-0.44612616,-0.06768961,
};
static float l4_bias_array[28] {
    -0.00941137,-0.50080097,0.01377150,0.05142068,-0.30054906,0.14652248,-0.22958848,-0.26256517,0.24136348,-0.15766755,0.05611604,0.70677888,0.22598767,-0.01273105,0.15255265,0.58617371,-0.05550962,0.05709424,-0.29572150,0.05654820,0.08825237,-0.05112489,-0.44021055,-0.01959763,0.36042157,0.04834750,0.33956176,0.13888742
};
static float l4_output_array[28];

static matrix_t l4_weights{28,28,l4_weights_array};
static vector_t l4_bias{28,l4_bias_array};
static vector_t l4_output{28,l4_output_array};

/******** Layer 5 ********/
static const float l5_weights_array[140] {
    0.51909423,0.17974953,-0.02224845,0.09606948,-0.12738916,0.54644972,-0.29598516,-0.04642798,-0.72152245,-0.23270410,0.67563605,0.24678545,-0.09119519,-0.40957353,0.12735797,-0.41491640,-0.10036425,0.02014115,-0.19257508,-0.02258183,-0.01734070,-0.18680528,-0.01367986,-0.18414815,0.27402893,0.10104175,0.32156539,-0.85907108,
    0.11927052,-0.37316823,0.03626563,-0.51577741,-0.93238902,-0.52836448,-0.19845989,0.52798283,0.29497331,0.68877542,-0.19997463,0.00723745,-0.31427196,-1.07860827,0.28856573,0.11981510,0.65572399,-0.79054874,-0.01420815,-1.20521033,1.49173057,0.24176584,-0.47605279,-0.96289921,0.80800986,-0.55821294,1.04805505,0.36706617,
    0.20510978,-0.85172492,-0.56352973,-0.39987496,-1.24742758,-0.57016969,0.28257808,0.04525183,-0.12069602,0.87585980,0.12572119,0.98013723,0.09970048,-0.67674315,-0.26452810,-0.10792684,0.36312366,-0.03674674,-0.96656489,-0.14482354,0.24732636,0.19361322,0.39737415,0.19190197,0.78741884,0.39071715,0.70506072,-0.09200079,
    -0.06847710,-0.24918917,-0.81932789,-0.96497416,-0.38254243,-0.62299335,-0.58117825,-0.67140919,0.22117116,0.37351245,0.78294551,0.70527542,-0.17894270,-0.51760101,-1.15619910,0.48186994,0.00498390,-0.61548823,-0.23190722,-0.48130143,0.09566259,-0.55347329,0.41214472,-0.47021425,1.29473734,-0.09121817,0.85439444,0.14068790,
    0.17234159,-0.82737052,-0.39209735,-0.68583417,-0.63839126,-0.50961435,-0.26855439,0.09360958,-0.67610312,0.39548436,0.15994880,1.04188251,0.05397223,-0.74828309,-0.51138014,-0.00757091,0.02061007,-0.06119937,-0.33861631,-0.62968701,-0.10928788,-0.37373787,0.46566364,-0.33061895,0.66524190,0.56811172,0.53067642,-0.52739489,
};
static float l5_bias_array[5] {
    -0.32295874,-0.10667151,0.19463013,0.40521574,0.27503875
};
static float l5_output_array[5];

static matrix_t l5_weights{5,28,l5_weights_array};
static vector_t l5_bias{5,l5_bias_array};
static vector_t l5_output{5,l5_output_array};

/******** Network ********/
static layer_t layers[6] {
    {l0_weights, l0_bias, l0_output, quicknet::quick_tanh},
    {l1_weights, l1_bias, l1_output, quicknet::quick_tanh},
    {l2_weights, l2_bias, l2_output, quicknet::quick_tanh},
    {l3_weights, l3_bias, l3_output, quicknet::quick_tanh},
    {l4_weights, l4_bias, l4_output, quicknet::quick_tanh},
    {l5_weights, l5_bias, l5_output, quicknet::quick_linear},
};

template<typename T>
NeuralNetwork<T>::NeuralNetwork() : network{6, layers} {
}


} /* namespace dsme */
#endif /* NEURALNETWORK_H_ */

/*
 * openDSME
 *
 * Implementation of the Deterministic & Synchronous Multi-channel Extension (DSME)
 * introduced in the IEEE 802.15.4e-2012 standard
 *
 * Authors: Florian Meier <florian.meier@tuhh.de>
 *          Maximilian Koestler <maximilian.koestler@tuhh.de>
 *          Sandrina Backhauss <sandrina.backhauss@tuhh.de>
 *
 * Based on
 *          DSME Implementation for the INET Framework
 *          Tobias Luebkert <tobias.luebkert@tuhh.de>
 *
 * Copyright (c) 2015, Institute of Telematics, Hamburg University of Technology
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the Institute nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */

#ifndef NEURALNETWORK_H_
#define NEURALNETWORK_H_

#include "./quicknet/Math.h"
#include "./quicknet/Network.h"

namespace dsme {

template<typename T>
class NeuralNetwork {
public:
    NeuralNetwork();
    ~NeuralNetwork() = default;

    quicknet::Vector<T>& feedForward(quicknet::Vector<T>& input) {
        return this->network.feedForward(input);
    }

private:
    quicknet::Network<T> network;
};

/***IMPLEMENTATION***/

typedef quicknet::Layer<float> layer_t;
typedef quicknet::Vector<float> vector_t;
typedef quicknet::Matrix<float> matrix_t;

/******** Layer 0 ********/
static const float l0_weights_array[392] {
    -0.12969202,-0.80062753,0.65159726,0.25277743,-0.63324869,-0.32048807,0.08474854,-0.03037477,-0.15480316,-0.13819358,0.23179589,0.52498472,-0.52879643,0.85406125,
    -0.27066335,-0.38418499,-0.01046151,0.14114435,-0.73316216,-0.46584561,0.01846819,0.01215260,0.72587287,-0.73875260,0.25573462,-0.00007962,-0.33372748,-0.32050344,
    -0.33337152,-0.01303831,0.05056681,-0.33024424,-0.12402266,0.52260697,0.03628567,-0.15340416,-0.80629265,-0.68362075,-0.03030102,0.03862489,0.31966338,0.63931590,
    -0.38592002,-0.25633392,-0.04449705,-0.31951782,0.46434614,-0.28709197,0.65256989,-0.21697815,-0.17095040,-0.31643128,0.22730052,-0.03356509,0.94911325,0.58169538,
    -0.27605149,0.42945993,-0.28758049,0.28702992,-0.04778145,-0.47527939,0.35484487,-0.48092714,0.12252991,-0.78378814,0.07577595,-0.56082368,-0.56951654,-0.08109671,
    0.23152879,0.62876332,-0.54183275,-0.15644857,-0.37101692,-0.43999931,0.86200410,-0.09277567,0.07279680,0.32276753,0.20844966,-0.77326423,-0.06188095,0.77214521,
    -0.15082327,0.13251130,0.44726551,-0.07584462,0.13922338,-0.41007319,-0.45502207,0.66283506,0.05939018,-0.47761294,-0.34218547,-0.53581393,0.12176504,-0.17608535,
    0.33719996,-0.29490006,-0.03824688,-0.74418259,-0.30179173,-0.05733229,-0.21541694,0.12597252,-0.01806640,-0.40279052,0.18290770,0.03324359,-0.24396043,-0.18728670,
    -0.53964502,-0.13117583,-0.45341116,-0.10703861,-0.02914139,0.29955873,-0.21218692,0.04099577,-0.23456429,-0.03177207,0.25949475,0.14831182,-0.42252821,0.94042659,
    -0.51585782,-0.07361927,-0.43107927,0.42996892,0.04863767,0.22229518,-0.00201364,-0.53449988,-0.42335579,-0.27417430,0.47791564,-0.59264743,0.28644940,0.13174661,
    -0.17859849,0.43138272,1.13312840,0.24706396,0.38133824,0.28777471,-0.11812858,-0.28117198,-0.25608423,-0.12725547,0.77107745,0.28398770,-0.25775078,-0.47397473,
    0.39658150,-0.53944963,0.02830165,0.41129205,-0.23288910,-0.44845572,0.69003791,-0.50510687,-0.12555970,0.72401172,0.10917418,-0.64260465,0.25566927,0.23927236,
    -0.03369240,-0.03494715,-0.30023921,-0.70518869,-0.07396886,-0.44225132,-0.65558690,-0.72815305,0.18561247,-0.42831308,0.40842536,-0.12891643,-0.14730981,0.20512842,
    0.17762198,0.08418740,0.44770208,0.48736930,0.60357773,0.61966491,0.52510923,0.02247928,0.17693686,0.04839002,0.30030230,0.26546717,-0.34958073,0.32194299,
    -0.33320147,-0.46756119,-0.02763641,0.45497137,0.02778113,-0.72824514,-0.52766490,-0.13198420,-0.15190615,0.21447502,-0.14976417,-0.15683310,0.52258730,0.21268965,
    0.66187066,-0.12244181,-0.18959819,-0.29062620,-0.39045843,-0.79705566,0.58634508,0.14501175,0.14621089,0.59766710,0.10690260,-0.38248274,-0.52733701,0.12260460,
    -0.16152830,0.26652637,-0.69421452,-0.25232437,-0.00256307,0.29863024,-0.30645785,-0.59561557,0.82751793,0.03340678,-0.59986824,0.63952816,0.51118517,-0.19409031,
    0.67924887,0.01882825,0.26127580,-0.58956587,0.27442089,-0.02182665,-0.39270455,-0.04499060,0.18887134,0.01627452,-0.20329131,-0.05920275,-0.58027494,0.71363056,
    0.06754982,0.60775334,0.30718532,-0.08887996,0.16511181,-0.14130768,0.45603460,0.21545234,-0.07544528,-0.28946713,0.15792002,0.29226479,0.78188568,0.21141738,
    -0.48042011,0.17999642,-0.32783195,0.09015974,-0.70587993,-0.55291086,-0.39643064,0.00760006,-0.02976851,-0.27421656,-0.37401268,-0.40267169,0.09099540,0.32254791,
    0.24843059,-0.47230354,-0.37249509,0.66129476,-0.32973316,-0.29518718,-0.34417084,0.81789106,-0.20657016,-0.11300096,1.53950512,-0.10509554,0.27876285,0.11572721,
    0.25543246,-0.82627171,-0.40889174,-0.53771478,0.33580264,0.01329106,0.68377024,-0.10381628,-0.65138686,-0.10800413,-0.82585895,0.10653906,0.09202890,-0.08188007,
    0.44912922,0.03144708,0.17448865,0.07823656,-0.18682271,0.90764380,0.04228023,0.01379039,0.04677329,-0.55274135,-0.07163027,-0.94622105,-0.28683442,0.44968906,
    -0.09800762,-0.51991874,-0.18646774,-0.43439534,0.06995743,-0.26670584,-0.54652905,-0.35012341,-0.30938053,0.01813114,-0.03535816,0.34260368,-0.54743201,-0.24425238,
    0.65504479,-0.56823039,0.08494224,0.31055629,0.69421595,0.05734545,-0.12801731,0.22600611,-0.56543899,-0.02343722,-1.24654806,0.01942240,0.64994764,0.11645899,
    0.15109710,0.21649106,0.35803190,-0.64868307,-0.36824599,-0.09951118,0.22797152,-0.32555225,0.42183906,0.14063010,0.38387117,0.09038973,0.42892796,-0.22373310,
    0.40053990,0.84057593,0.37702113,0.13521418,0.43562961,-0.45306224,0.20359528,0.63872433,-0.17257321,-0.08998972,0.10664517,-0.03152474,-0.26016030,-0.02611827,
    -0.89847124,-0.14829421,-0.05193536,-0.70613611,-0.39073557,-0.27956218,-0.26015252,0.35648403,-0.31987122,0.06745292,0.12079547,-0.42531639,-0.34600821,-0.30691677,
};
static float l0_bias_array[28] {
    -0.01746827,-0.03599281,-0.01287464,0.10253982,-0.26997980,0.00254881,0.05040574,-0.08605844,0.03473559,-0.07133184,0.03278113,-0.12818468,-0.06565960,0.05462573,0.06361693,-0.17995124,0.01412116,-0.00300751,0.15671150,-0.00464459,0.19759391,-0.26094982,-0.07369038,-0.13311218,-0.19365925,0.04611466,-0.02855103,-0.10994985
};
static float l0_output_array[28];

static matrix_t l0_weights{28,14,l0_weights_array};
static vector_t l0_bias{28,l0_bias_array};
static vector_t l0_output{28,l0_output_array};

/******** Layer 1 ********/
static const float l1_weights_array[784] {
    -0.17186356,-0.78801656,-0.02371781,-0.37788147,-0.21113224,-0.14512485,-0.52749741,0.41484502,0.14921546,-0.32987946,0.09483822,-0.21192800,0.18225539,0.56593388,-0.74993080,0.13506979,0.36938810,0.66948825,0.23011854,-0.26836452,-0.54733372,-0.08211886,0.39058831,-0.09864306,-0.02344161,0.39723346,0.33521491,-0.64370894,
    0.19599728,-0.42189994,0.20688003,0.16143879,0.00459720,0.42864648,-0.38043809,-0.11077440,0.49366239,0.12744290,0.21525408,0.47540328,-0.00629475,0.57057858,-0.23528723,0.40597031,-0.52940136,-0.17087558,-0.42943570,-0.08148126,0.45398021,-0.31194127,-0.21914397,-0.08078701,-0.47016758,-0.00614708,-0.39706057,0.17994194,
    -0.25176653,0.11313196,-0.32165655,-0.66019583,0.26344982,-0.28198820,0.24050480,0.45918563,-0.53261513,-0.10807194,-0.26414713,-0.28331444,-0.29153946,-0.61587375,0.12705529,0.21758519,-0.22004104,0.44421273,-0.19752491,0.29235861,-0.43276134,-0.05624725,0.36885923,0.53458339,0.56385803,0.19845505,-0.12582682,0.33737323,
    0.08812694,-0.18391258,0.52918023,0.51381058,-0.60043198,-0.06087206,0.24614242,-0.00024094,0.56543976,0.31508842,0.62752742,-0.26929843,-0.64679360,0.08487128,0.21420090,-0.57680249,-0.00345213,-0.24530220,-0.16642025,-0.14692567,-0.59762436,-0.41993302,0.01714731,-0.08600692,-0.26029897,0.12061735,-0.24111032,0.72102034,
    0.16534249,0.05061933,-0.12376904,0.54164881,-0.41573116,-0.22976290,-0.64232743,0.45002589,-0.35806015,-0.06534190,0.55347824,-0.06135193,0.35790953,-0.24963929,-0.23343354,0.23813923,0.12285740,-0.33691907,-0.12791789,-0.76899940,0.16169611,0.23669653,-0.31707796,0.53235281,-0.31708601,0.41219842,-0.58750439,0.02998385,
    -0.41052696,-0.54636037,-0.23674753,-0.36043963,0.36341432,0.13439046,0.43673325,-0.35523927,0.01187033,0.29307458,0.54600519,-0.21830654,-0.45676297,0.07295174,-0.29822522,0.32512692,-0.54339576,-0.14829893,0.32890552,-0.11228121,-0.06761998,-0.05325979,0.14734222,-0.37749112,-0.06604119,-0.31597328,0.61016119,-0.13559583,
    0.24908918,-0.24256551,-0.62938058,0.07483258,0.22434713,0.38538268,-0.38971710,0.00644498,0.11386352,-0.06438240,-0.21291566,0.83910644,0.50938016,-0.11990025,0.32881626,0.78160775,-0.30296546,-0.11103036,-0.37048459,-0.05101534,-0.09309094,0.33257931,-0.18353340,0.48017156,-0.34392497,0.57329065,-0.04784963,0.01061258,
    0.39240661,-0.24104866,0.52983856,0.80812424,-0.28614420,0.52280015,0.29668492,0.09398303,-0.22634673,-0.17642426,-0.30200228,0.07521406,-0.13203827,0.56737095,0.02295241,0.04243260,-0.43444243,-0.10449938,0.40318492,-0.27958277,0.17273249,-0.11859218,0.44590914,-0.47421303,0.19976093,0.36074707,-0.04276363,0.07790161,
    0.55908340,0.74737817,-0.19739439,-0.32381132,0.22511005,-0.29738292,0.25443774,-0.12056025,-0.31535971,-0.06153590,0.25117078,0.56727445,0.14371817,-0.00172567,0.06483399,0.34910503,-0.36343902,-0.04424568,0.03428464,0.27693614,-0.56850606,-0.27746397,0.39138272,-0.23205332,0.07909033,0.34181395,-0.32042959,0.02581724,
    -0.00567170,0.20609432,0.31149104,0.17095555,0.44006404,-0.13539504,-0.23823468,-0.35472661,0.53887033,0.70804209,-0.10640731,-0.28187138,0.29041290,0.03941100,0.41131455,-0.51833224,0.69508445,-0.44338396,-0.43111086,0.57990450,-0.32634208,0.07226115,0.17033149,-0.20057589,-0.60745943,-0.10478989,-0.66050804,-0.11094256,
    0.26500559,0.42375213,-0.43360922,-0.50388348,0.19176543,-0.34528020,-0.00248139,-0.34423682,0.14364593,-0.20938487,-0.20381564,0.29536653,-0.17114863,-0.35555163,0.23941809,0.22072208,0.39984310,-0.34101278,-0.22857046,0.34940931,-0.38761210,-0.58233732,-0.47602403,0.15119271,0.03180028,0.01420502,-0.24863489,0.15358548,
    -0.21951732,-0.02933027,-0.36587581,-0.30182782,0.27648467,0.29679665,-0.09997280,-0.09312207,-0.42995912,0.39774248,0.01708609,0.24831901,-0.09563430,0.62529534,-0.33071426,0.06548251,-0.39559343,0.13283129,-0.47584456,-0.21139695,-0.05862592,-0.14340426,0.67807072,-0.68371660,0.51768744,-0.41536346,0.44266906,-0.94555509,
    -0.10198717,-0.04167898,0.03998566,-0.01985068,0.01803510,0.16428897,0.03397061,-0.14245747,0.05945546,-0.00989363,-0.28515974,0.24083333,0.15842265,0.15754420,-0.14421956,-0.30273461,0.41429248,0.27012151,0.24475907,0.14859289,-0.26747334,0.11450357,-0.05715084,-0.40762621,0.70029509,0.45082158,0.17879912,-1.16243982,
    0.53831512,0.30190206,-0.20066614,-0.34677750,0.45973420,0.25990841,0.34825230,-0.00043447,0.14686787,0.01278625,0.14797314,0.11786919,-0.10899850,0.17059465,-0.09205230,0.54626232,-1.25398874,0.22133526,0.41295955,0.24112947,0.20619774,-0.06225358,0.26295900,-0.08238217,-0.52412313,-0.21802771,0.64979208,0.54568982,
    -0.01022893,-0.00622443,0.12750861,0.74853265,-0.13678037,-0.36040694,0.35071617,-0.17406015,0.05116320,0.04827531,-0.12685700,0.23237029,0.05965167,-0.59631801,0.43400580,-0.25995380,0.00954805,-0.31558275,0.33011046,0.61711198,0.26888970,0.25251111,0.04055956,-0.35978857,0.56746686,-0.13907993,-0.28619838,-0.11382392,
    0.26305351,-0.07889649,0.23496753,0.02943002,0.49034825,0.30175939,0.09166744,0.51269096,0.22110869,0.14928305,-0.38457131,0.41270247,-0.15821925,-0.48058414,-0.11227703,0.46952271,-0.52609521,0.14279293,-0.19112799,-0.16758613,-0.32521188,1.06283593,0.41504604,0.49885544,0.27132231,-0.16006884,0.35783678,0.41331461,
    0.51615119,0.43179172,0.18090224,-0.32136422,-0.35359657,0.08234972,0.14839414,0.66895908,0.60079098,0.00031147,-0.43912721,-0.38314596,0.53034621,-0.51751888,-0.20929310,-0.25217056,0.40667790,0.54134637,-0.45577377,0.33138460,0.05007611,-0.39644748,0.23148678,0.39285269,-0.17039390,-0.22608985,-0.09629795,0.53646541,
    -0.29454973,-0.50112289,0.07425630,-0.05011090,-0.25926644,0.29417369,-0.29272997,0.12308928,-0.07339479,0.07952386,-0.87700284,0.32573560,0.25044882,-0.98880154,0.50174266,0.34010401,0.17665370,-0.05947709,-0.14397147,0.52348679,-0.01520519,0.32544667,-0.56641418,0.27983594,-0.02979636,0.02062270,-0.19856282,0.36457437,
    0.02808935,-0.33996227,-0.02366511,0.08056820,0.27947015,-0.08465118,-0.31780314,-0.21654938,-0.11125788,0.31710482,0.44190720,-0.16872478,0.18468520,-0.10015334,-0.37732092,0.09929091,-0.03436447,0.32497907,0.27746019,-0.41535762,-0.95369452,0.43340164,-0.06175170,0.22448486,-0.18868436,-0.22146049,-0.08450101,-0.02514805,
    0.43567473,-0.94080120,0.14482005,0.07582588,-0.64384663,0.25188252,-0.40424421,-0.28970924,-0.02024053,0.14489852,0.20112206,0.04572847,-0.29801250,0.47720197,0.19319841,0.04948271,-0.16612481,0.25034600,0.08338182,-0.29569307,-0.18548760,-0.07907594,0.13379511,0.12008522,0.28334913,-0.08357056,-0.63626957,-0.72858548,
    -0.96051371,-0.15604857,-0.38854423,0.55172104,-0.05596430,-0.19427568,0.41911212,-0.31319687,-0.47878945,0.55782169,0.65442169,0.10279688,0.01134859,-0.07294536,0.57847381,-0.28479287,0.13140173,-0.07036923,0.17767824,-0.28932819,-0.20080347,-0.21431875,-0.13781853,-0.54303390,0.18694627,0.19952694,0.11349863,0.19926247,
    0.23219395,-0.31939113,0.50624627,0.68543535,-0.29224557,-0.74593711,-0.54053241,-0.31866845,0.64304096,0.44701213,0.31597778,0.36917037,-0.22879015,0.87380928,0.52395022,-0.28986797,-0.15603453,0.25117585,-0.22115226,-0.28160003,0.07886062,0.40661871,0.28642136,0.52425516,0.45298862,-0.37706700,-0.33453184,0.08664659,
    0.31289500,0.24059497,0.20485668,-0.47280508,-0.15458398,0.54364240,-0.34662318,-0.22865018,0.00882777,0.11995487,-0.32721776,0.17940137,0.32891068,-0.06312875,0.07218663,0.01776921,0.27145121,-0.09183773,0.21380344,0.32531801,0.02647263,-0.70045954,0.35494143,-0.35349476,-0.23034728,0.09883864,0.01873332,-0.65703613,
    0.69109213,-0.23121405,-0.30696356,-0.64986068,-0.42142272,-0.51985079,0.04695872,-0.16923106,0.11441080,-0.14630182,-0.15579431,0.43832761,-0.81818700,0.13300940,0.35588494,0.09952196,-0.62042183,-0.00030269,-0.57451850,-0.15785740,0.35205796,0.49287891,-0.11035212,-0.05601758,0.56036800,-0.82027590,-0.24321775,-0.19978060,
    0.15172985,0.08787371,-0.12777908,-0.18313712,0.06337308,-0.27367964,-0.38072813,-0.19909450,-0.07585458,0.28812090,0.82981545,0.20066454,-0.42900127,0.89532298,0.12922277,-0.46567699,-0.19533238,-0.69421327,0.08114092,-0.28203028,0.21272916,-0.22043721,0.15940696,-0.01859625,-0.30925626,0.01167962,0.09441994,-0.49063936,
    -0.37840891,0.43297970,-0.01218130,-0.15296958,0.10476393,0.25563854,-0.28989354,0.33107397,-0.10826635,-0.20047054,0.42687181,-0.06928533,-0.67048109,0.25179473,-0.70111340,0.63118386,0.20340782,-0.51977402,0.03218846,0.12577866,0.18684116,0.04016867,0.43160921,-0.56092620,-0.40756613,0.56232339,-0.00284300,-0.14122695,
    0.07429572,-0.18423496,-0.46911064,-0.01360965,-0.26943156,-0.02532148,-0.18226859,-0.29792434,-0.24754578,-0.57437831,0.35901543,-0.41044277,-0.45339990,0.17582634,0.20703915,0.05167213,0.14822501,0.05520607,-0.22649379,-0.22102170,0.04672237,-0.16979095,0.07256103,0.10166048,0.62940007,-0.28126189,0.25788960,-0.32475886,
    -0.37540317,-0.31520316,-0.60779893,-0.67754030,0.10134331,0.00826226,-0.08199342,-0.21160299,-0.41122699,0.26251709,0.17815262,0.58268005,-0.42840856,-0.36981770,0.26535290,0.05143306,-0.01408319,0.26770827,-0.32486156,-0.06614657,-0.39279968,-0.56689107,0.03393101,-0.29567826,-0.17334892,0.07361157,0.24214792,0.19083849,
};
static float l1_bias_array[28] {
    0.18479176,0.11091549,-0.29820099,0.10744495,-0.04628944,0.14981417,-0.05573267,0.22582790,-0.06043204,-0.00382255,-0.14867900,-0.02476903,0.17371991,0.04157365,0.14277086,-0.38902551,-0.09625801,0.05989625,-0.30134711,0.20345540,0.16010514,0.09646375,-0.00392516,-0.00797319,-0.10188967,0.23197131,0.19606318,0.04026197
};
static float l1_output_array[28];

static matrix_t l1_weights{28,28,l1_weights_array};
static vector_t l1_bias{28,l1_bias_array};
static vector_t l1_output{28,l1_output_array};

/******** Layer 2 ********/
static const float l2_weights_array[784] {
    0.08869632,0.09177455,-0.00056343,-0.26751205,-0.10404608,0.69950241,0.39340991,-0.61952817,-0.07852046,-0.32156172,0.24660100,0.63146591,0.08884409,0.22645572,-0.72010368,-0.42275408,-0.34572032,0.65745807,-0.21377909,-0.47119394,0.00822470,-0.92606348,0.24502876,-0.12484706,0.22569704,0.24942864,0.12537882,0.64908022,
    0.68680066,-0.28141448,-0.18961725,0.21537158,0.09942854,-0.29632321,-0.17843746,-0.22360852,-0.44447806,-0.20881709,-0.09977614,-0.51826513,0.11376270,-0.66220278,-0.51416725,-0.48979118,0.04867326,-0.10441437,-0.04484035,-0.09165382,0.17144315,-0.39680722,-0.65094399,0.09001525,0.00643436,0.20100373,0.73032963,-0.35417765,
    -0.05919169,0.65351129,0.29666200,0.43264258,0.24074739,0.54665351,0.70868707,-0.12988274,0.24932519,0.41624284,-0.10293750,-0.25061524,-0.13652225,0.88634312,-0.51858050,0.67678857,-0.17043500,0.05847513,0.32560667,0.20908003,-0.27972871,0.41897154,-0.03569553,0.08296075,0.02575637,0.12124161,-0.64111978,0.38778999,
    -0.34578207,0.41383198,-0.35820726,0.04928780,-0.46641839,-0.25508538,0.15468343,0.30861920,0.05059000,0.20459273,0.06884211,-0.02954021,0.07519798,0.63892978,0.50217432,-0.02708655,-0.39618704,0.30961168,-0.39713082,0.00477132,0.45534962,-0.05500356,0.21945620,-0.62817568,-0.09057134,-0.46695274,-0.27023873,-0.31073707,
    -0.65092975,0.43194389,0.04784492,0.80258095,-0.39525047,-0.14721954,-0.69113851,-0.16922554,-0.07495720,0.01475789,-0.09084857,-0.35796773,-0.74122500,-0.07965076,0.03069386,0.03231202,0.92497683,0.21359150,0.03377254,-0.46144325,-0.34201479,0.08982310,-0.13183540,0.04484740,-0.39939323,-0.27789640,-0.16487861,-0.58591229,
    0.05162538,0.05435994,-0.11549777,0.37934908,-0.28448078,0.11700296,-0.12003867,-0.42272907,0.29111531,-0.14716329,0.00982063,0.17508131,-0.29304731,0.31536725,-0.19039869,0.07392589,-0.25660616,-0.61789197,0.43016136,0.41249645,0.14494208,0.25495529,0.22362445,0.51816547,0.46136427,-0.32216686,-0.07393654,0.44331625,
    -0.12344455,-0.28435066,0.56861264,-0.27366799,-0.55855405,0.07641479,-0.17814612,-0.50375634,0.26228583,0.70315450,-0.28811350,0.13367513,0.52116996,0.25048631,0.14061962,0.76271766,-0.08857803,0.30310330,0.05973981,-0.20725085,-0.47682589,0.28521574,0.13784721,-0.02553091,-0.33232656,0.53144240,-0.40363705,-0.09709231,
    0.70902687,-0.60435355,0.35706145,-0.29526255,-0.47892743,0.09080043,0.29641753,0.09369840,-0.14883266,-0.09694261,-0.13460059,0.34414628,0.75708514,-0.28245857,0.15065046,0.31013855,-0.09689294,0.01673858,0.19310240,0.03933553,-0.50670689,0.52296132,0.26918188,-0.00714022,-0.13261354,-0.19434729,-0.01553825,-0.01634330,
    -0.49053568,0.19004370,0.39469704,0.10028844,0.42807624,-0.23926336,0.53499174,-0.13223419,0.62911576,-0.02931544,0.97420180,-0.23676167,-0.38733113,-0.17914076,0.06019312,-0.09376106,-0.23244746,0.05790819,-0.29765788,0.16319031,-0.21982692,-0.11150797,0.07273018,-0.04656693,0.32798353,0.70609081,0.20033877,0.05324705,
    0.21286429,-0.24611925,-0.35189965,-0.34678215,0.19053705,0.34715560,-0.37306553,0.14458184,-0.18991843,-0.61189789,0.17247519,0.13343376,0.80127621,-0.14569379,-0.30058351,0.20643665,-0.17376237,-0.17903574,-0.04803163,-0.21250135,-0.51898092,-0.66413772,0.01849916,0.21598613,-0.06453371,-0.20045038,0.48685163,-0.68702251,
    0.26006928,-0.40622404,-0.01514028,0.00972692,0.47825864,0.53666317,-0.04079362,0.30876267,0.41384292,-0.01766641,-0.29443112,-0.03805571,-0.04834227,0.80320197,0.02674173,0.30902186,-0.44114891,-0.79213387,-0.20421910,-0.45654690,0.40740353,0.52167404,-0.53635639,0.09177859,0.46139485,0.67801470,-0.10636649,-0.37585548,
    -0.68092215,-0.23733373,0.22527015,-0.16866623,-0.44937271,0.29721370,0.27468187,0.28714007,0.25347042,-0.16976668,-0.15512417,-0.35626024,0.44212526,-0.07674502,0.07821365,-0.13953207,-0.21837617,0.62960404,-0.43114799,-0.38584146,0.34904417,-0.69005972,-0.14375643,-0.54809564,-0.02265581,-0.27953696,-0.30332202,0.61504942,
    -0.13173220,-0.40796012,0.71273035,-0.49193168,0.08893429,-0.30919939,0.37818122,-0.50589424,0.55518496,-0.53805715,-0.40212747,0.17700496,0.08003095,0.46583697,0.05057938,0.74398959,0.32817504,0.17142022,0.00237440,-0.42019144,-0.36020181,0.20220880,-0.23513758,0.69490594,-0.09043206,-0.42977282,-0.43830520,0.01943878,
    0.01892198,-0.17499298,0.19763094,0.53880966,-0.28057700,0.37273771,-0.27537277,-0.67579085,0.35201281,0.23637603,0.18017700,0.22521052,0.27318057,-0.34844214,-0.63716072,-0.23620577,0.10737465,0.08456133,0.39869401,-0.62860042,0.17379375,-0.50855660,0.34013763,-0.58059061,0.59813440,0.29372054,-0.09758718,0.45369637,
    -0.33803135,0.50957501,-0.40049779,-0.33561349,-0.36601287,0.45333335,0.23925309,0.56913507,0.24535003,-0.71213788,0.14822356,0.34334856,0.21886916,0.48933494,-0.51368231,-0.11623464,0.32448298,-0.28050172,-0.85220242,0.38874468,-0.76111650,-0.88352394,0.26644742,0.51508069,-0.07936981,-0.15791662,0.35472786,-0.18937564,
    -0.57867962,-0.45423281,0.47719210,-0.44800767,-0.17454152,-0.09445623,0.09800882,-0.11580967,0.65898740,-0.31702977,0.26321757,0.76165026,0.42562753,0.17470457,-0.21286140,-0.39888149,0.31716990,-0.07805936,-0.14331180,-0.43917984,-0.19690429,-0.06544499,0.35408312,0.40198505,-0.01361604,0.43103492,0.21531145,0.10477545,
    0.39263999,-0.33481425,0.63911992,-0.25444219,-0.30834058,0.50574452,0.25974345,-0.12788147,0.14841747,-0.11430056,0.15698096,-0.18866988,-0.55547661,0.88318443,-0.54284763,0.23246168,-0.34073457,-0.21280688,-0.39639005,-0.53742957,-0.00587750,-0.05096131,-0.17279930,0.32782075,-0.38837335,-0.21056923,-0.27105394,0.56802922,
    0.18508391,0.55003661,-0.73739052,-0.07740568,0.07465291,0.21652985,-0.42996666,0.33911943,-0.46025309,0.46387634,-0.00925743,0.27640915,0.28092691,-0.18982241,0.26859182,-0.63756382,-0.04928698,-0.35821149,-0.40452874,0.08741383,0.33326417,0.00103899,0.77878773,0.33648455,0.45753330,0.53381920,-0.38219935,-0.23847252,
    -0.28254440,0.49812585,-0.50131822,0.46573862,-0.13914795,0.43421900,0.60364205,-0.21611166,-0.14630017,0.21530862,0.38774323,-0.09242927,0.07347818,-0.34504589,-0.08743505,-0.58199579,-0.69875133,-0.30632910,0.30872259,0.10559121,0.37908190,0.37361878,0.09984110,0.09817164,0.31346485,-0.02549847,-0.14692329,-0.31939155,
    -0.08658087,-0.15796839,0.42500430,0.67616516,-0.25929612,0.09659716,-0.10145532,-0.68769282,-0.35639063,0.85667288,0.59104002,-1.14942300,-0.56398004,-0.00166991,-0.18766616,-0.14316362,-0.12826966,-0.60583991,0.33376694,-0.09712611,-0.07510940,0.33683813,-0.06714943,0.43735355,0.03040265,-0.36956930,-0.31748033,0.10468756,
    -0.35219762,0.75379652,-0.41491053,-0.30733773,0.41474092,-0.33844462,0.22278869,0.17686367,-0.42647466,-0.39055297,-0.45170626,-0.03293492,-0.32469073,0.04599216,-0.50739473,0.18331666,0.52714437,0.64913476,0.20707293,-0.50315815,-0.42929932,0.15733093,-0.08568725,-0.38739529,0.17958936,0.09408589,-0.21912855,-0.22799063,
    0.17806685,-0.11403365,0.09244828,-0.34772891,0.72191727,-0.61183548,0.50783956,-0.20500548,0.04653355,-0.32930905,0.31880140,-0.43243936,-0.14284672,-0.09086611,0.20760092,-0.00782253,-0.12998536,0.53320450,-0.05188946,0.34231657,-0.20895350,-0.23319495,-0.22800961,-0.14223674,-0.09760773,0.22922386,-0.13515699,-0.48695511,
    0.30737144,0.17973909,-0.29672927,0.65917373,0.12875788,0.07635388,0.75430906,0.03516023,0.14724874,0.52455091,0.35478699,-0.79590309,-0.27884936,-0.16787091,-0.32843256,-0.46123850,0.23301578,-0.00625273,0.24259922,-0.11169580,0.53368479,0.27317786,0.43893558,-0.40880761,0.15530731,0.37691098,-0.62502146,0.38415104,
    0.25112218,0.20464565,-0.02672249,-0.12926285,-0.06177485,-0.21541765,-0.52939880,0.17230463,-0.44601685,0.18948457,-0.42201668,0.13493711,0.46427444,-0.07563638,0.46915072,0.38659698,-0.31213665,-0.54893595,0.26123875,0.52727288,0.02821711,0.70695174,-0.37904224,-0.16684493,0.39303616,-0.14236146,0.08175771,-0.21344469,
    0.12933460,-0.17231812,0.43118992,0.35911962,-0.41601741,0.85848588,-0.52522612,-0.08955706,-0.65641737,-0.48092899,-0.54851151,-0.32649621,-0.12658402,0.32840610,0.22297095,-0.14020477,0.35927823,-0.00804694,-0.33406717,-0.26284650,0.52219653,-0.13199389,-0.69809067,0.15473564,-0.56166273,-0.45048338,0.40911740,0.43302035,
    -0.35532609,-0.38471836,-0.04046754,0.20761554,-0.62093914,0.37979820,-0.09646440,-0.64974815,0.01850605,0.38093579,0.64006519,-0.02011375,-0.00565921,-0.37215936,0.32658789,-0.08553936,-0.13422576,0.26294127,-0.24375963,-0.41842064,0.38551989,0.61271155,-0.29066363,0.35861817,-0.31539088,-0.60394609,0.11395860,0.49515665,
    0.00487187,-0.43624538,-0.23745672,0.20909290,-0.89553648,0.17560270,-0.08062854,0.24673079,-0.60720444,0.88485277,-0.54556566,0.28476623,0.49751461,0.15473735,0.34626979,0.57488513,0.36712626,0.07678166,-0.67487693,-0.48839232,-0.11445279,-0.07499288,0.21002463,-0.07909604,-0.64835680,-0.20798951,-0.51601052,0.00290375,
    -0.43108711,0.46513030,-0.21630052,0.68265259,-0.38185048,-0.35950819,-0.54087949,0.23042545,-0.14964983,0.09469865,-0.19328338,0.10508632,-0.46122524,0.34764245,0.18435790,-0.21158850,0.24400161,-0.20773181,-0.08197456,0.25209334,-0.06599842,0.10007162,0.47574094,-0.36864251,0.43480554,0.30770525,0.09960078,-0.48446181,
};
static float l2_bias_array[28] {
    0.08030032,0.29303554,-0.12034084,0.30504751,-0.01164217,-0.16842616,-0.30720356,-0.10741394,-0.11305873,0.20308992,0.10188292,0.05269532,-0.35846794,-0.12875281,0.22596103,-0.18364125,0.04384281,0.27004477,0.17570195,-0.24423735,-0.00859119,0.21944062,0.01326981,0.15958466,0.03972126,-0.19774245,0.03580397,0.18237388
};
static float l2_output_array[28];

static matrix_t l2_weights{28,28,l2_weights_array};
static vector_t l2_bias{28,l2_bias_array};
static vector_t l2_output{28,l2_output_array};

/******** Layer 3 ********/
static const float l3_weights_array[784] {
    -0.22388549,0.26698741,-0.69764090,0.19359978,0.07351027,-0.47153237,-1.11539137,-0.19793588,-0.29816556,0.13486254,-0.26923391,-0.24117364,-0.39974919,0.20237184,-0.02425170,-0.48071238,-0.11539591,-0.09301659,-0.15757681,-0.36666501,0.67530084,0.23464535,-0.68279290,0.36490554,0.25555301,-0.29673839,-0.31336713,0.10206177,
    -0.07241692,-0.19708951,-0.03331094,0.60009938,0.10891392,-0.12395006,-0.03292141,-0.43398631,-0.50779974,-0.25390586,-0.62830883,0.80679965,-0.22887143,0.26217306,-0.28765100,0.23946536,-0.19895297,-0.42416194,-0.63019931,-0.05169697,0.49452704,0.17521872,-0.26823384,0.27426305,-0.31357250,-0.35977030,-0.47613031,0.31328291,
    -0.30126849,-0.46193543,0.61694634,0.47036868,-0.45821247,0.20543134,0.59349263,0.36158758,-0.11116195,-0.28417328,0.57526487,-0.05015568,0.07720545,-0.23936042,-0.60571009,-0.28793609,0.11039003,-0.21833713,0.42716825,-0.15790261,-0.64225167,0.29300115,0.26209781,-0.13252825,0.48176560,0.09149937,-0.29479966,0.06259575,
    0.90748799,-0.01038177,0.09818162,0.41596889,0.19309385,0.21149254,-0.38290012,-0.47586179,0.28050202,-0.39672810,-0.12136863,0.56403881,-0.19510323,0.37879291,0.41027385,-0.31191257,-0.02658971,-0.03886884,-0.09025551,0.06157523,0.21011758,-0.10194331,-0.37971172,0.09741979,-0.28753105,0.21913426,-0.70762092,0.61444587,
    -0.42113292,-0.63765448,0.53496861,-0.14405791,-0.15928850,-0.25327104,0.27410528,0.29254463,0.24595197,0.13915721,-0.20643385,-0.18400982,0.16010270,-0.33183783,0.35116026,0.19513339,0.01358869,0.30474842,0.06373545,0.88372171,-0.44865608,0.72351229,-0.14222617,-0.20211627,-0.09238908,0.15951052,-0.31150311,-0.26630226,
    0.73763651,0.20860073,0.41281182,-0.00337507,-0.49414650,0.28513777,0.40110612,-0.10124731,-0.13591786,-0.16680405,0.48089269,-0.17738691,0.59290791,0.14133391,0.35544550,0.27362201,0.90389287,-0.45530838,-0.21031581,-0.01338106,-0.45251742,0.26588508,0.00703247,-0.00488844,0.28271714,0.33770698,0.73779112,0.26138306,
    0.34871867,-0.24683520,-0.11205500,0.58125317,-0.10836197,-0.61082745,-0.05941226,-0.26007289,0.43780938,-0.39918506,0.19552895,0.39039031,0.40109861,-0.39922559,0.26612160,0.24585032,-0.25704014,-0.11882786,-0.31460050,0.28440508,0.05498678,0.69867802,0.07243115,0.11282095,-0.20656228,-0.27829078,0.18089759,0.33045298,
    -0.37311339,-0.63258713,-0.09857401,-0.00814579,0.10742338,0.28449383,0.09879898,0.20244901,0.36362016,-0.24100041,-0.68844640,-0.06014950,0.16526867,0.63509977,0.05611847,0.38826406,0.27545747,0.02822082,0.28077424,0.27221137,0.16662949,-0.22590140,-0.03466281,-0.21184880,0.34016493,-0.24629292,-0.40316015,-0.50495344,
    0.51356506,-0.28464508,-0.12139350,-0.47071770,-0.71750021,-0.31380826,0.55962825,-0.00029237,-0.01671937,0.32103989,-0.28290874,0.24866536,0.41761741,0.71870571,0.12369131,0.82741219,-0.03538283,-0.30325699,-0.38792941,-0.06865419,0.01452428,0.48440561,0.78207952,-0.61581361,-0.68980181,-0.19597028,-0.28573680,-0.43090966,
    0.62282437,0.14053530,-0.28777835,-0.37914324,0.04125328,0.27946562,0.22571544,-0.29482284,0.06535202,0.08873197,0.52113879,-0.18338887,-0.43441847,0.23325662,-0.48004335,0.06028847,0.15063438,-0.02518315,0.28241986,-0.27127218,-0.18395366,-0.02445721,-0.21116440,0.58941251,-0.00237834,0.49033177,-0.45972392,-0.30339432,
    -0.03462670,-0.56755024,0.81996065,0.09843000,0.13654046,0.31878570,0.69062686,0.20179975,-0.07430214,-0.10794001,-0.58396620,0.14337626,-0.33042046,0.11765078,0.17120461,-0.10759189,-0.51836079,-0.56820810,0.16489330,-0.49793375,0.33130282,-0.05980166,0.07203136,0.31972814,-0.62337583,-0.14489721,0.25436234,-0.48312056,
    0.55032325,-0.43318957,0.07045636,0.09972939,0.36873001,0.06515991,0.04009243,-0.16892740,0.06693358,-0.37066260,-0.04348497,0.57424086,0.31379810,0.37651882,-0.39025846,0.62529868,0.55544066,-0.16376641,-0.35668579,-0.18911134,-0.09963631,-0.04839561,-0.04504993,-0.32081607,-0.66958511,-0.19375584,0.24564473,0.41515008,
    -0.46039975,-0.02320026,0.40317285,-0.28660989,-0.41742849,0.23127632,-0.38519081,-0.15441865,-0.50067484,-0.12193316,-0.24017194,0.01625003,0.27369532,-0.08145585,-0.68620992,-0.12269651,-0.17056231,-0.49416101,0.11715913,0.38205314,0.00722309,0.33062446,0.01876343,0.39893478,0.54205149,0.26912028,-0.26990679,-0.20588060,
    -0.29838890,-0.52517766,0.40813845,-0.12604661,-0.28722531,0.03622409,-0.05337594,0.11902240,0.24951139,-0.73391861,0.24345228,-0.55345136,0.18214346,-0.02470492,-0.95678794,-0.12938389,-0.34913462,-0.42969272,0.48362955,-0.01585258,-0.30351958,0.34416094,0.47393706,0.28966638,-0.12520012,0.02120490,-0.24488084,0.00591329,
    0.36827996,-0.37169021,0.16958697,-0.12525593,-0.29771230,0.19067082,-0.12713060,0.88358003,-0.32852814,-0.02905644,0.48596841,-0.16093028,-0.30415615,-0.14186738,0.20106721,0.23490128,0.26360291,0.02576764,0.20111865,-0.54341215,-0.63349348,-0.41403854,-0.39992648,0.44097015,-0.56903785,-0.63471752,0.00678475,-0.10299305,
    -0.65770596,-0.15619917,-0.45988923,0.14880635,0.26785058,-0.10092965,0.34823626,0.17831592,0.09428056,-0.15299448,-0.22712080,-0.04506336,-0.28302675,-0.30090517,-0.38774794,-0.19362332,0.24702895,-0.08609376,0.10091243,0.49996868,-0.37004179,0.44991851,0.66964149,-0.25378656,-0.26451665,0.35600650,0.43277153,-0.52630037,
    -0.01296909,0.34631753,0.06246134,-0.73662835,-0.34701702,0.50867152,0.43277526,0.43237087,-0.20199394,-0.09543249,0.78046089,-0.82552081,-0.07516368,0.00377650,0.22407946,0.40617344,0.06822178,0.13669172,0.04541710,-0.12610982,-0.57491183,-0.37970039,0.31919390,0.17985715,0.08862019,-0.20328282,0.17464902,0.00381770,
    -0.08293533,0.35195360,0.43182617,-0.32923508,-0.08899787,0.33900464,0.25951415,-0.29121223,-0.15728684,-0.36915478,0.52543670,-0.38297516,-0.32271934,-0.32733876,0.04160088,-0.00414662,0.21867158,0.53221571,0.10647061,0.69485086,0.45807773,-0.30051360,0.45388463,0.32240659,-0.32097396,-0.08275913,0.13274017,-0.13797070,
    0.44565642,-0.01498007,-0.29645798,0.15555412,-0.88110262,-0.49843663,0.07059765,0.55988342,-0.40976200,-0.01700171,0.47590578,-0.25900996,-0.28189486,0.46594903,0.67360455,0.34553084,0.09682559,0.28580484,-0.04659864,-0.46392763,-0.27432516,0.09702472,0.77113038,-0.43022531,-0.26706278,-0.07918948,-0.94828355,-0.53669405,
    0.00121097,0.22487344,0.27578235,0.29370257,-0.28997636,0.22306556,0.41932699,0.26940516,-0.46747729,-0.00573829,0.59577459,-0.25645331,-0.52326298,-0.33632162,0.37417921,-0.49853426,0.17421810,0.18533532,0.32993564,-0.54764593,-0.20104243,-0.68106800,0.06450475,0.20580553,0.69633681,0.43536282,0.93612421,-0.21501651,
    -0.17873465,-0.01144058,-0.38512996,-0.38174549,-0.24424295,0.29591376,0.23489483,0.42737231,-0.06753192,0.11976581,-0.12464484,0.19376954,0.83920705,0.63711661,-0.62695056,0.41202545,0.15247193,-0.59568310,-0.33206511,0.22425227,0.10080176,-0.19759640,0.03217766,-0.47917390,0.15759601,0.38410765,0.85527450,-0.70856303,
    -0.17254481,-0.21429642,0.06648125,0.27387282,-0.62553048,-0.44838560,0.75189447,0.22892578,-0.47876489,-0.30897638,0.54089379,-0.18590213,0.46784425,0.03774538,-0.14911151,-0.48934013,0.28543550,0.07293759,-0.03072059,0.54947722,-0.40391693,0.19905889,-0.01168820,0.11589279,0.06584393,0.60331899,0.58076704,-0.14957692,
    0.04115710,-0.16311458,0.48032320,-0.36281022,-0.41782734,-0.14283976,0.07650729,-0.01130839,0.23307876,0.23130965,0.47822171,0.52481520,0.13931417,0.17608905,-0.24171376,0.01508496,1.18037093,-0.37546298,-0.22766867,-0.08047120,0.13905646,-0.19735014,0.41448322,-0.10866275,0.31206965,-0.51245308,-0.36841264,-0.41894820,
    0.22000812,-0.25714076,-0.19543944,-0.24018197,-0.04349186,0.38774031,0.47628295,0.06369173,0.05010487,-0.19072004,-0.09420282,-0.27528286,-0.12168626,0.60477340,0.21577308,0.32698208,-0.50198650,-0.39225769,0.07222614,-0.43716636,-0.51227987,-0.44268563,-0.36575747,0.44273806,0.23624049,0.62188900,0.06532630,-0.16285774,
    -0.41158426,-0.44264123,-0.40319341,0.27565873,0.39220104,0.27884144,0.34688947,-0.28442714,-0.24975018,0.38316134,-0.41512752,-0.02466563,-0.31599286,-0.59673250,0.02114896,-0.12056619,-0.59274292,0.27074671,0.19114475,-0.26399732,0.57281983,-0.17972811,-0.09350290,0.25292838,-0.02749370,-0.13406712,0.27692202,0.43852320,
    0.35615504,0.42127463,-0.23101993,-0.08171131,0.25141263,-0.38433015,0.12223071,0.30161738,0.37427723,-0.42115828,0.07271466,-0.24811801,-0.14013025,-0.21010502,0.58303189,0.49270380,0.27757898,-0.09578367,-0.42524487,0.58873665,-0.54221219,0.33770129,0.54576349,-0.32187906,0.81887418,-0.08115769,-0.33666274,-0.03065349,
    -0.20476291,-0.04463854,0.68496466,-0.25857991,0.53420961,0.73072857,0.55179429,-0.27652705,-0.68942779,-0.41579992,0.27917761,-0.07599990,0.45488784,0.28692412,-0.41394880,0.30592564,-0.06673922,-0.25888723,0.16643673,0.17143945,0.49118671,-0.36711290,-0.06376449,-0.50583059,0.24083725,0.53213054,0.35496894,-0.24575780,
    -0.61721373,-0.78733319,0.09105538,-0.03674455,0.42786938,0.06478717,0.43329757,-0.03155398,-0.64736968,-0.18055287,-0.21162874,0.10158005,0.93902659,-0.03583492,0.03093967,0.19889943,0.19735987,-0.07393179,-0.23024091,0.63286555,0.07946187,-0.41415444,-0.31447890,-0.19794562,0.43297967,0.59936935,0.24960232,0.07584791,
};
static float l3_bias_array[28] {
    0.26617280,-0.16228803,-0.27674553,0.31342235,0.00536461,0.35330641,0.15065621,-0.49128693,-0.37262154,-0.20750025,-0.10283544,-0.17114550,0.00705273,-0.01549338,0.02805432,0.02101771,0.08161281,-0.24049994,-0.05417027,-0.06983382,-0.46598935,0.12370802,-0.08903928,-0.52452826,-0.15651576,-0.09766810,-0.76453298,-0.38010594
};
static float l3_output_array[28];

static matrix_t l3_weights{28,28,l3_weights_array};
static vector_t l3_bias{28,l3_bias_array};
static vector_t l3_output{28,l3_output_array};

/******** Layer 4 ********/
static const float l4_weights_array[784] {
    -0.33158249,-0.28784859,0.74933016,-0.60722870,0.19951285,-0.07688424,0.23473245,-0.09503068,0.28121355,-0.24234989,0.21497655,0.03758847,0.24759251,0.81460005,-0.27132273,0.41944084,0.31436157,-0.32786447,0.30046797,0.47368151,0.35982516,0.24351107,0.09748159,0.28644958,0.11213432,0.38504735,0.36564052,0.16142200,
    0.03589504,0.47570428,0.39604971,0.35252455,-0.10002317,0.16238755,-0.09363938,0.03199173,-0.27283469,0.33489302,-0.11543174,0.04219376,-0.10772752,0.17862411,0.46104884,-0.32109883,0.35053921,-0.04107294,0.39866880,0.13126792,-0.32469380,-0.07882051,0.25758564,-0.28044498,0.34704345,-0.29514366,0.07951024,0.18849964,
    0.54132110,0.44215542,-0.33537549,0.53376144,0.11254535,-0.18641780,0.34481776,-0.52348381,-0.07382620,-0.11167012,0.23145850,0.15046388,0.04091289,-0.31514359,0.35595620,-0.59670937,-0.08272187,-1.05209279,0.23527922,-0.61025101,-0.12962872,-0.65905797,-0.25437096,-0.19723229,-0.16506477,-0.35057762,-0.36272794,-0.31868824,
    0.28693959,-0.27506712,0.26941860,0.04195509,-0.14377604,-0.08363320,-0.79819524,0.16474643,-0.17965524,0.83623475,-0.27612737,-0.17178331,0.40564570,0.13641781,0.73387402,-0.00671221,0.19207819,0.11806011,-0.13623878,0.20188552,0.04901868,-0.27167878,0.26688898,-0.48776892,-0.03107171,-0.65475750,0.01287352,-0.84670138,
    -0.17052867,0.58161473,0.19108498,0.29888633,0.05396960,-0.61089206,-0.03083506,0.10614525,0.41903433,0.31930935,0.12774400,-0.13662246,-0.19221252,-0.02633661,0.14835094,-0.37200230,0.04705212,-0.14029159,0.73307186,0.34916443,-0.06019706,-0.57150358,0.17423382,0.37686202,0.04697805,0.47406179,0.57009131,0.03156267,
    -0.63236731,-0.29772887,1.06671774,-0.25559050,0.08862194,0.24099150,-0.50511938,-0.28101829,0.27187786,0.40794086,0.05773080,-0.09584135,-0.39381957,0.06903012,0.74270707,-0.11881706,0.75760621,0.14026541,0.13679282,0.89020681,0.15242769,0.75757861,0.48364806,0.86648577,0.10619209,0.12691402,-0.00221210,-0.09152737,
    0.31811798,0.30211705,-0.50072867,0.23166546,-0.64626282,-0.24338584,0.11288060,-0.09761652,-0.22273359,-0.67255729,0.00546956,-0.11751755,-0.10809566,-0.86100525,-0.45923167,-0.22093959,-0.61596137,-0.13530461,-0.91992658,-0.78082186,-0.24020520,-0.57612580,-0.41749534,0.21610998,-0.05430399,0.09217860,-0.10348684,0.05131868,
    -0.39264780,0.46324623,0.17243315,-0.06226844,-0.06080881,0.48318514,0.11994114,0.34239691,0.15816632,-0.11605490,0.19643632,-0.15366760,-0.07054297,0.12770627,-0.41887668,-0.17692457,-0.16157579,0.13078757,-0.48752508,0.11355668,-0.10104565,0.11734721,0.14578322,-0.07971093,-0.51973635,0.06074211,0.55314547,-0.19671473,
    0.41670781,0.50612640,-1.31977224,0.73702556,-0.37088788,-0.49824235,0.53991419,-0.09738296,-0.31344530,0.04177606,-0.19115858,0.15978649,-0.02671087,-0.46245885,-0.12860040,-0.17009269,-0.70315915,-0.46235445,-0.46520066,-0.73616028,-0.34879965,-0.66683185,-0.66143239,0.53139108,0.13506389,-0.30944657,0.15663844,0.12772773,
    -0.01128553,0.23869833,0.23344979,-0.26914501,-0.12961979,0.10972730,-0.10770128,0.38751504,-0.28899449,-0.49551931,0.44853252,0.73626989,0.33485976,-0.15675437,-0.41102666,0.35844341,-0.12849683,0.02358826,-0.74442434,-0.33342308,0.28705227,-0.63505435,0.13966204,0.09508177,-0.46311146,-0.45692080,0.01657186,-0.36414212,
    -0.23316444,0.44578439,-0.37575758,0.00436546,0.12506075,-0.35889751,0.18438341,-0.55016172,0.14443526,-0.21397522,-0.20476408,-0.05055155,-0.00589733,0.08135431,-0.17201133,0.16970152,-0.35312721,-0.46038336,0.20837118,0.09368119,0.42559347,0.13484660,-0.24709931,-0.42198372,0.30524206,0.18938865,-0.07570971,0.05971572,
    -0.02979064,0.03017363,0.04703611,-0.10291912,-0.15000093,0.08181623,0.38626701,-0.41002849,0.62179875,-0.48174962,-0.48477834,0.12377406,-0.01479591,0.15830053,-0.24905956,0.18804929,-0.00065872,0.15412487,-0.33470687,-0.05276629,0.07874952,0.16095959,0.06070977,-0.87152070,0.04774887,0.27794802,-0.55925477,-0.50730813,
    -0.09136279,-0.05752802,-0.37659442,0.42995995,-0.12495840,-0.31582725,0.49749884,-0.36352435,-0.36930934,-0.06717081,0.25274578,-0.22426830,-0.39154515,-0.00681659,-0.04135171,0.39968857,-0.49035463,0.21216497,0.09169535,-0.10258144,-0.67072237,-0.18819176,-0.61993736,-0.19563545,0.06760311,-0.41186598,-0.29905793,-0.26696619,
    -0.11769535,0.17100067,0.14438689,0.46275613,0.76829100,-0.52295780,-0.44922942,0.12212419,0.10198348,-0.29406589,0.13216622,-0.68725049,0.04333258,0.43167683,0.19414435,0.10470227,-0.32968989,0.05408025,0.19538371,0.15293884,-0.35914880,0.15532272,-0.23077501,0.47734028,0.28749174,-0.19569153,0.09588078,0.05154197,
    0.17392577,0.08112334,-0.09107362,0.49081311,0.00244535,0.57902330,-0.36583832,-0.15461983,-0.37311071,-0.07089568,0.24037395,0.53385067,0.20947276,-0.34705824,0.53441423,-0.47389618,0.18566725,-0.67440528,-0.10565264,-0.37531915,-0.07520881,0.04819641,0.01796454,0.24830905,-0.17982106,0.26764950,-0.29363304,-0.17210484,
    0.20606138,0.14151469,-0.33442429,-0.15717158,0.01734411,0.34882355,0.73471576,-0.60286397,-0.55114079,-0.40209708,-0.08773208,0.05398919,0.14852870,-0.31618088,0.21746229,-0.20427413,0.05747969,-0.11442271,0.06658786,0.02857508,-0.31645736,0.03399585,-0.09678199,-0.20923828,-0.07357038,-0.17640460,-0.41553167,-0.38924474,
    -0.40957317,0.17261267,0.80551821,-0.20667602,-0.35650828,-0.37718099,-0.34762090,0.32226214,-0.45112649,-0.34432033,0.68030107,0.41254768,0.19393043,0.41791192,-0.47331843,0.66213852,0.04379001,0.19378644,-0.55671602,-0.06052060,-0.09450803,-0.38709155,-0.09641933,0.17442818,0.20693997,-0.22760721,0.30724630,-0.50929809,
    -0.11623204,-0.23993452,0.35579079,-0.33063853,0.58498180,-0.26607782,0.17450584,0.55431855,-0.15614372,-0.06442681,-0.33695886,-0.53835398,-0.53419560,-0.73724848,0.23282957,0.14913997,-0.34051034,0.03531108,0.43459502,0.42706564,-0.15200129,0.18994121,0.39578310,0.28136733,0.22049470,-0.46972805,-0.28123227,-0.46866885,
    0.48810223,-0.10343146,-0.08860236,-0.30069986,-0.94539189,0.21824780,-0.32481575,-0.10974541,-0.48162389,0.48644978,0.17001699,0.37664166,0.22401080,0.09197785,0.23893112,0.37567386,0.37785324,-0.47479814,0.13218555,0.23674724,-0.25011873,0.12351476,-0.18116237,0.33387443,0.11450619,-0.15143034,-0.05399047,-0.18438840,
    -0.26336879,-0.13309857,0.56414318,0.23778223,-0.26153290,-0.13075213,0.51093012,-0.09702357,0.69782668,0.13096298,-0.43280280,-0.35144180,-0.83707684,-0.28221375,-0.16238856,0.16153084,-0.14472114,0.62016118,-0.30245852,0.77901006,-0.20976976,-0.07192430,0.56583554,-0.36188433,0.10983846,0.29837772,-0.40573251,-0.97890425,
    0.24617948,0.95443529,0.32254574,0.17302564,-0.28345418,0.05445398,0.07999289,0.09580762,-0.29444155,-0.40130270,0.33192965,0.67286491,0.60391182,0.09868641,0.08499047,0.20624916,-0.86994302,-0.87198073,-0.70433497,-0.52732593,-0.23923104,-0.20631146,0.49585652,-0.44862834,-0.34184012,-0.58169752,0.23257965,-0.07975008,
    0.63296604,0.51220620,-0.19272651,0.26002914,-0.26841429,-0.55738848,-0.12138595,-0.01966473,-0.10424915,-0.13464604,0.07466837,-0.45573470,-0.41590825,-0.81091994,-0.22538283,0.00148010,-0.97100347,0.22989555,0.33252460,-0.90243214,-0.26849288,-0.50526071,-0.68129039,0.04201134,0.18566670,-0.51671499,0.06367066,0.18367968,
    -0.11418014,-0.61930382,0.59319651,-0.79420835,0.53164983,-0.01722686,0.12241784,0.11771215,0.71942675,-0.12052273,-0.26565731,-0.76158094,-0.37562433,-0.17937346,-0.62159550,0.20132110,0.52795750,0.50841039,0.72795141,1.04609525,0.06607813,0.49834496,-0.08885229,-0.18954918,-0.14348261,1.16955268,0.11396571,0.02826114,
    0.38680369,-0.14383887,-0.22751337,0.11666807,-0.19629334,0.44397163,0.17286612,-0.15760922,1.02119553,0.24791260,-0.38735723,-0.28720868,0.13288188,-0.64164549,-0.41955957,-0.57260495,0.01895104,0.38285300,-0.01689250,0.08073168,0.11111581,0.01133573,0.30788720,0.27702963,0.13338459,0.35182011,-0.01327864,-0.02532613,
    -0.05309664,0.21784256,0.02791663,0.28959545,0.48834655,0.36712593,0.35126436,0.00656049,-0.47625914,-0.04611694,-0.27973709,0.16269697,0.40981522,0.22342704,-0.49841762,0.16707860,-0.42370224,0.13415359,0.37257019,-0.22606120,-0.08012078,0.36451060,-0.62763351,-0.35169366,0.26360923,-0.05937009,-0.40292037,0.07972571,
    -0.23760723,-0.57315284,0.88384187,-0.70471781,0.03246323,-0.26323855,-0.56198281,0.02851175,0.39607874,-0.14550442,0.17722683,0.11839329,-0.14965950,0.09027026,0.30179369,0.35800403,0.39188361,-0.09674358,-0.08520436,0.82518548,0.38535792,-0.15939817,0.21963049,-0.29449454,-0.46985173,0.34554213,0.08149320,0.10565394,
    -0.32129505,0.46200123,0.03623810,-0.12695570,0.11566743,0.27953136,0.41122982,0.08922277,-0.28976491,-0.07716218,0.00018567,-0.09080032,0.05103777,-0.14828093,0.19715680,0.19322351,0.17615138,-0.56410396,0.45127416,-0.17603415,0.31001464,-0.53427339,-0.01066704,-1.12016082,-0.52685428,0.30356187,-0.53947496,-0.05468583,
    0.48700985,0.36534277,-0.78340268,0.61529821,-0.52001834,-0.13218097,0.29936039,0.29201582,-0.31025058,-0.09066302,0.07540278,0.06570572,0.00204872,-0.75148958,-0.14581120,-0.20418391,-0.59672052,-0.28209260,-0.52402353,-0.98550057,-0.59213269,-0.75496250,-0.69915366,0.63773602,0.30379635,-0.14238387,-0.34744138,0.03973747,
};
static float l4_bias_array[28] {
    -0.33330527,-0.46994698,0.14288852,0.04525135,-0.34152666,0.17717819,-0.06782204,-0.39426777,0.13045672,0.08366452,-0.07912356,0.49648601,0.28487426,0.09195640,0.25186527,0.62879252,-0.05638419,0.05822353,-0.09330051,0.14533129,0.00049631,-0.00607227,-0.45376286,0.10596808,0.38034299,-0.08946139,0.34116605,0.08669732
};
static float l4_output_array[28];

static matrix_t l4_weights{28,28,l4_weights_array};
static vector_t l4_bias{28,l4_bias_array};
static vector_t l4_output{28,l4_output_array};

/******** Layer 5 ********/
static const float l5_weights_array[140] {
    0.74122667,0.20531835,-0.16329788,0.06370823,0.08622907,0.57798791,-0.39038399,0.15297502,-0.77885443,-0.14860043,0.51443195,0.09945389,-0.15819921,-0.25761655,-0.17581382,-0.56116182,0.05797534,-0.02923660,-0.13499010,-0.05523134,0.02504344,-0.40337279,0.04027958,-0.16117512,0.09779001,0.30007601,0.18480147,-0.92261058,
    -0.15042077,-0.12820201,0.04858776,-0.11963975,-0.52656776,-0.38578311,-0.21201932,0.39850426,0.19253471,0.57412636,-0.39837986,-0.23568600,-0.36610994,-0.64353389,0.40186220,-0.14658913,0.55230182,-0.65489823,0.13253203,-0.76674032,1.40118480,0.13658971,-0.36196104,-0.83028489,0.36817113,-0.12176806,0.63649064,0.31724456,
    0.13897067,-0.67236060,-0.39548555,0.11542851,-1.12538815,-0.48826933,0.51663166,-0.02273880,-0.17092077,0.72285813,0.08536825,0.93345940,-0.04844969,-0.47213155,-0.24769674,-0.10306896,0.38165501,0.33820122,-0.69038868,0.13795401,0.24140036,0.38827500,0.38395581,0.37322259,0.28146017,0.70905286,0.56613266,-0.08651394,
    -0.10259426,-0.09618423,-0.59623295,-0.79762506,0.07178840,-0.59256774,-0.50170016,-0.53685999,0.15248868,0.04264141,0.79055989,0.61810023,-0.28877699,-0.23900023,-0.92347831,0.35947829,-0.21979611,-0.61725342,0.03852548,-0.40362516,-0.03676208,-0.78944653,0.35749432,-0.03902048,1.06446469,-0.12441934,0.72204787,0.06906722,
    0.04705080,-0.56497020,-0.29225639,-0.36559093,-0.50160909,-0.65289903,0.12231796,-0.05744118,-0.31146482,0.29603067,0.16363020,1.06025779,0.38425693,-0.61051822,-0.55084389,-0.10505667,-0.06401372,-0.06141610,-0.40136942,-0.47354120,0.05866857,-0.38124979,0.18613586,-0.21505162,0.50010824,0.40755987,0.50231093,-0.15795238,
};
static float l5_bias_array[5] {
    -0.45350307,-0.33087125,0.11472101,0.31665081,0.29796976
};
static float l5_output_array[5];

static matrix_t l5_weights{5,28,l5_weights_array};
static vector_t l5_bias{5,l5_bias_array};
static vector_t l5_output{5,l5_output_array};

/******** Network ********/
static layer_t layers[6] {
    {l0_weights, l0_bias, l0_output, quicknet::quick_tanh},
    {l1_weights, l1_bias, l1_output, quicknet::quick_tanh},
    {l2_weights, l2_bias, l2_output, quicknet::quick_tanh},
    {l3_weights, l3_bias, l3_output, quicknet::quick_tanh},
    {l4_weights, l4_bias, l4_output, quicknet::quick_tanh},
    {l5_weights, l5_bias, l5_output, quicknet::quick_linear},
};

template<typename T>
NeuralNetwork<T>::NeuralNetwork() : network{6, layers} {
}


} /* namespace dsme */
#endif /* NEURALNETWORK_H_ */

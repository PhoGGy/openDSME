/*
 * openDSME
 *
 * Implementation of the Deterministic & Synchronous Multi-channel Extension (DSME)
 * described in the IEEE 802.15.4-2015 standard
 *
 * Authors: Florian Kauer <florian.kauer@tuhh.de>
 *          Maximilian Koestler <maximilian.koestler@tuhh.de>
 *          Sandrina Backhauss <sandrina.backhauss@tuhh.de>
 *
 * Based on
 *          DSME Implementation for the INET Framework
 *          Tobias Luebkert <tobias.luebkert@tuhh.de>
 *
 * Copyright (c) 2015, Institute of Telematics, Hamburg University of Technology
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the Institute nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */

#include "./NeuralNetwork.h"

namespace dsme {

/******** Layer 0 ********/
static const float l0_weights_array[80] {
    4.25114870,4.43770933,-0.38493082,-6.52784109,
    -3.38391423,-3.47004914,-5.91699314,2.40388036,
    -1.32305920,-0.77731407,-2.42090297,-1.00426602,
    3.53961539,3.85628510,-0.42475766,2.56222177,
    5.39979553,5.06609583,5.09115601,-2.84920454,
    0.83739287,0.85839027,-8.12578869,5.11038876,
    -1.85249615,-2.11778164,-1.73977983,-2.33003688,
    8.91723919,8.23601723,2.02691007,-0.50327379,
    12.86013031,12.61573219,-0.05767096,-0.38001591,
    -0.63406754,-0.82213324,-3.11350441,2.77087522,
    7.17603779,7.44673681,4.63370943,-2.07590508,
    1.38048589,0.57831460,0.66248208,5.12519026,
    7.90595198,8.23799515,-3.34065080,2.56156492,
    5.28513145,5.80027294,3.60778117,-3.40351820,
    -4.47592402,-4.19666624,1.25457954,-4.48838568,
    2.18864894,2.36690307,5.86287212,-4.15453959,
    9.64931297,9.43624496,-0.03071397,0.04045489,
    3.18874025,3.83184195,-0.78423399,4.12192392,
    4.50718355,4.52643251,6.21802711,-4.02988243,
    -3.03907442,-2.93949986,-1.90476942,-0.99958867,
};
static float l0_bias_array[20] {
    -0.13999386,0.31170037,1.50101066,-2.08333302,-1.06901145,-1.85782075,1.64252222,-1.15391409,-0.81915498,1.27322757,-1.03181458,-2.20936871,-1.70361817,-1.04084873,2.06023073,0.23600689,-1.04036117,-2.11896491,-0.31786332,1.30975235
};
static float l0_output_array[20];

static const quicknet::matrix_t l0_weights{20,4,l0_weights_array};
static const quicknet::vector_t l0_bias{20,l0_bias_array};
static quicknet::vector_t l0_output{20,l0_output_array};

/******** Layer 1 ********/
static const float l1_weights_array[400] {
    -1.68923652,1.32304811,0.68441391,-1.26867628,-0.99779278,-0.96927440,1.06801939,-1.50139761,-2.23189402,1.53342736,-1.69726503,0.70412570,-2.00291991,-0.94420934,3.24092603,0.30979443,-2.07418489,-0.49501675,-0.73952401,1.66608644,
    -1.17836964,8.11851788,5.37497425,-0.18535751,-0.81035095,9.22220421,4.32408142,-0.11439896,-0.08163834,6.90800381,-0.61416900,-1.51669562,0.94907963,-0.64093697,-1.48597431,-0.63914484,-0.25707251,-0.13665794,-0.84672803,5.16434479,
    4.04379177,2.06962538,0.88827527,-1.05451941,-0.69863188,-0.59641612,2.25627542,-0.65056968,-0.41597396,0.64941633,-1.39384353,-3.41153336,0.44148636,-0.08318342,3.65677166,-0.13547961,-0.50783902,-1.35055614,-0.43758756,2.13610125,
    3.17975998,-0.00845469,1.56831121,-1.49398446,0.13224559,-2.57236576,2.38010502,-0.33706066,-0.14360029,-0.15994598,-0.14592440,-2.83096170,-1.79646611,0.43022105,6.13999128,0.81407225,-0.58421487,-2.36610007,0.59555978,1.35298026,
    0.33047697,-1.19232845,-0.72813910,1.37636030,0.49906227,0.56673598,-1.22102571,1.53262806,2.56116867,-0.99795258,1.66911924,0.24814312,1.99603975,1.16030419,-2.93804765,-0.11805880,1.89545989,0.92043889,0.34279990,-1.74302924,
    -2.29533052,1.56707287,0.14180610,1.09656966,-1.29543400,5.47698736,-1.04302382,0.04344542,0.01444577,1.57429087,-0.48415783,1.60434484,1.07060421,-1.26414764,-5.15961313,-4.13752460,0.20817226,1.75407255,-2.33984613,-0.54654723,
    3.29173899,-1.80140221,-0.94885778,0.61904013,1.57960665,-0.15509768,-1.13374710,1.27673948,2.34706664,-1.42703915,2.21552134,-1.22474301,1.59181798,1.45427370,-1.91524065,1.34449196,1.61906135,0.40370861,1.80983078,-1.47965455,
    0.18073918,-1.30620682,-0.67915547,1.43156481,1.33918726,0.51112199,-1.11242378,2.16887689,2.82347989,-1.06113875,1.84467614,0.91512668,2.18759489,1.37656689,-2.47817492,0.17751926,2.14606738,1.48450565,1.24025559,-1.20672917,
    -1.33250296,8.35836887,5.15064812,-0.86212522,0.00282367,8.15018082,4.99603891,-0.31331745,-0.32458496,6.72635508,-0.23887061,-1.29483843,0.47633228,0.00975887,1.86979842,-0.67985320,-0.36258301,-0.34562799,-0.40409222,5.87249279,
    1.93502915,0.35493210,1.24601150,-1.74121356,0.32568261,-2.32942247,2.78849053,-0.48335436,0.20546886,-0.39355651,0.41895038,-2.65796280,-1.72709870,-0.08829155,5.95330095,0.25915110,-0.53981620,-2.08856702,0.62355804,1.91947293,
    -1.37272429,-1.91132975,-2.08049655,1.51785612,1.50558901,-3.04084373,-2.53159356,1.20157421,0.45312834,-1.37587392,1.04291189,2.69412613,0.46938810,0.93004996,-2.36296916,1.17338717,0.49530724,1.81524515,0.98221159,-2.14735174,
    3.08064723,-2.76021481,-0.74404383,-0.05979346,1.89066732,-3.13626599,-0.40025097,1.18431950,1.18044531,-2.28176069,2.53447270,-0.75025362,-0.20801148,2.50188947,0.60443187,3.76833534,0.53260624,-0.33319458,3.54061198,-1.67168868,
    0.87376243,-1.48553288,-0.81893492,1.23492110,0.77697688,0.03518952,-1.58436847,1.47221053,2.46129274,-1.04670870,1.96548951,0.23562662,2.19440317,1.55685830,-2.68381524,0.30246368,1.51504028,0.90181714,0.64446992,-1.10139143,
    0.36998978,-1.21816599,-0.68935454,1.19709527,1.97763622,-0.48755220,-1.29924679,2.62361193,3.41010118,-0.88634741,3.24354506,0.59891272,2.37767982,1.95662355,-2.52096415,0.82416815,1.87171340,1.80258346,2.30315328,-1.52911174,
    -2.62517357,1.87212420,-0.31404787,0.63776314,-1.23813307,5.17792702,-0.39051172,0.12633859,-0.14355631,1.48324573,-0.78588700,1.44392931,1.73466551,-1.20233345,-4.97873640,-4.03309250,0.05533355,1.37296093,-2.81008625,-0.42539951,
    0.79993004,-1.10949767,-0.70182204,1.23221850,1.42902315,-0.16405930,-0.81330007,1.69953096,2.23886013,-0.59982252,2.33925200,0.74100918,1.93891358,1.94501734,-2.59224653,0.93963265,1.70302868,1.48045361,1.57069325,-1.62773860,
    -1.09974015,8.78962231,5.47334814,-1.07113123,0.07584483,8.26826096,5.70365906,0.00505836,0.19585255,6.90498924,-0.33703232,-1.24912608,0.06999087,-0.22429591,2.95628119,-1.16330731,-0.20562674,-0.79461706,-0.08675823,6.67711306,
    -0.84042084,-1.04237700,-0.84661889,1.58762300,0.86773890,0.96706277,-1.41146362,1.71863532,2.15153480,-0.45111585,1.20268333,0.84695905,2.34472227,0.81550795,-3.13610435,-0.77853304,1.13512635,1.30211830,-0.29344445,-1.58527458,
    -4.20148277,2.90954804,1.07140088,-0.83077705,-1.86756253,1.14029968,2.00365567,-0.75138861,-0.11390174,2.38986182,-1.23093128,1.52875876,-0.21056631,-1.99684179,2.43335652,-2.02041411,-0.02962122,-0.08196685,-1.77505672,2.56533623,
    -6.49355030,0.36073732,-0.61446589,1.25493670,-0.21760976,2.16410279,-1.91912961,0.28545550,0.90950251,0.86509436,0.01653557,3.56830883,1.17956495,-0.61797643,-4.26806641,-1.11645186,0.55808723,2.64434838,-0.45100400,-0.53399318,
};
static float l1_bias_array[20] {
    0.90446836,-0.04371771,0.41118363,0.54411370,-0.73034883,-0.58733803,-0.70712268,-0.39570814,0.45345476,0.28024924,-0.13172449,-0.13680845,-0.73832393,-0.46451637,-0.50218439,-0.48122433,0.40502587,-0.78839797,1.00980377,-0.27438903
};
static float l1_output_array[20];

static const quicknet::matrix_t l1_weights{20,20,l1_weights_array};
static const quicknet::vector_t l1_bias{20,l1_bias_array};
static quicknet::vector_t l1_output{20,l1_output_array};

/******** Layer 2 ********/
static const float l2_weights_array[400] {
    0.94502670,1.81278110,1.83938932,1.07173789,-1.16037846,-2.99705672,-0.54024982,-1.31303716,0.44368610,0.55750382,0.83672982,2.38106394,-0.82599974,-0.95684814,-1.94916773,-0.69941062,0.34538630,-1.39181840,-0.88269371,-6.64591503,
    -6.07634735,-0.36293688,-0.97341549,-2.23137093,2.98103786,-0.14739360,5.38897085,1.71795785,-0.90985024,-1.20027351,-0.26119310,5.29764462,3.55145502,1.45803356,-0.07179973,2.25583959,-0.25374791,2.10392785,-1.82123566,1.91127169,
    -2.31139374,-5.02092695,-4.80523062,-5.16129065,0.59279662,5.52310896,0.77779096,0.12850696,-5.88566351,-5.22656012,2.06983209,0.82125884,0.75035316,0.37069222,2.21906877,0.41102418,-6.42894650,0.19242993,-4.06404448,0.95368594,
    2.41351867,4.56191587,-4.44175196,-1.82217371,-0.17928798,6.19040728,-0.46492779,0.57554013,3.78378010,-2.66239691,-0.27646583,-0.50486696,-0.28035957,0.06138414,5.96539593,0.14237756,2.77918887,-0.40168118,-3.06018543,2.66422462,
    -0.29100081,-1.08502841,0.07351547,2.84712601,0.15731123,-9.13179874,1.62916958,-0.27600223,-0.37206417,1.32759857,0.31877419,3.53271484,0.43993697,-0.36204782,-9.66214085,0.00235966,-0.51237100,-0.53312826,-1.51402509,-2.44839406,
    -1.64863038,0.48950899,-1.24150622,-4.87599754,0.27352035,5.32754707,-0.84025705,-0.16118695,0.86987704,-2.91660810,0.90664148,-3.48302364,0.18862556,-0.46419764,5.56678343,0.14729016,0.91843462,0.41694927,1.22822690,3.67230153,
    -0.44069654,0.09994625,-0.03541541,0.32282633,2.92582417,0.63185817,2.88107443,2.86967707,0.42039451,0.45239657,1.59573627,-0.29864621,3.06764627,3.07889771,-0.04985443,2.13215041,0.85616571,1.88064849,-0.15507658,1.30232859,
    0.07504703,0.05151065,-0.24006504,-0.57978535,-0.46982434,2.40417838,-2.91607022,-1.03851426,-0.27626580,-0.34122834,-5.06125116,-8.89035892,-0.86959082,-1.64139628,1.98877048,-1.53524423,-0.50486928,-0.03757818,-0.00858497,1.60984647,
    -2.37939477,-0.05535030,-0.76528680,-0.27686200,3.56599450,-0.42338750,4.14890862,3.47330761,-0.43133762,0.11687076,2.60718107,1.33696198,3.27873945,3.96679473,-0.38586906,3.14944458,-0.17570414,2.44372392,-0.90736711,1.88498652,
    -4.15739202,-1.17938101,-0.57354122,-3.16134858,0.83669847,-2.20945382,0.75979739,0.84132206,-1.80468369,-2.60572433,1.69029760,0.79111451,0.12326825,0.34195137,-2.36884236,0.52023524,-1.48584795,0.26905733,-4.94260693,3.21265364,
    0.59103560,-0.36669531,0.14416987,2.30743933,0.39617771,-4.30090523,0.26291859,0.34228709,0.20734580,2.22825575,4.07225943,3.33328533,0.32922786,0.55271131,-4.39280891,0.57826197,0.09111401,0.06141588,-0.71613443,-2.21408677,
    0.75080734,0.82084185,1.21684217,1.39507484,1.04015136,1.06353140,0.87833697,0.82224244,0.90150321,1.68096614,1.30416334,0.64043415,0.99814647,1.37284267,1.25958991,0.62061685,0.86169386,1.17284262,1.00212181,1.25467658,
    -4.87587023,-1.16257763,-1.73062205,2.59124517,0.48311776,-9.25107670,1.41527712,0.33219284,-0.97709066,1.85916328,3.05563140,2.39957070,0.94091809,0.64691776,-9.23241997,0.46571019,-0.54169822,-0.03512701,-2.40766573,-2.18741512,
    -0.77830726,-0.36847436,-1.77197921,-0.82732475,0.81074077,-3.44093680,1.46067059,1.05354285,-0.00710364,-0.09348491,7.21902704,5.25404644,1.24074709,1.28319418,-3.54832411,1.34544969,0.03202307,0.83787787,-1.51585734,-1.27796841,
    2.13335323,7.58309412,6.73454952,-3.27885294,-0.87407690,11.76799202,-0.85793197,-0.56085044,4.10415554,-2.58424568,-4.00510025,-1.65691817,-0.71423221,-1.08723271,10.42176056,-1.08260477,3.91852832,-0.95759022,4.97074652,0.89368814,
    -2.43131042,-1.94774306,1.47532117,3.39648581,0.60286051,-3.12556958,1.80360949,0.22303504,-2.03194451,1.83292234,-1.99365211,2.05909681,0.63216597,-0.11496452,-3.24791574,0.45334983,-1.57526779,0.39448974,-1.30035603,-2.06569695,
    5.64689350,-1.32333028,6.85414696,2.76135468,-0.10730142,1.08871567,-1.10432231,-0.10900640,-0.18518977,3.03588557,-5.92349958,-2.40199614,-0.84165800,-0.31399828,2.85793829,-0.16184559,0.31878826,0.02230984,8.93893147,-1.05280507,
    3.52124739,0.45470849,1.21303761,0.82716876,-6.04570389,-0.60649824,-7.92089558,-5.07900524,0.69046783,0.40453848,-5.44724178,-6.24620199,-6.18339252,-6.05682659,-0.26502195,-5.39779711,0.15270662,-5.16626787,1.27928114,-4.73686600,
    -14.70238876,-0.80927461,-4.24842882,-6.66740704,1.19006407,1.26194370,2.32192183,0.95093536,-0.60305649,-4.73675013,9.99158955,2.77550316,1.15447974,0.19947742,0.68808341,0.32609567,-0.41163367,0.89842987,-3.61096334,2.89557052,
    -2.85828757,-0.44184980,-1.27175951,-1.26664615,1.92777061,0.55035102,3.24818826,2.03565931,-0.59008205,-0.60462856,0.62445891,2.89388418,1.69826877,1.88233113,0.09568600,1.35826170,-0.17724234,1.46440399,-1.32869375,1.81828642,
};
static float l2_bias_array[20] {
    0.19136687,-0.60221815,0.35148337,0.40924138,0.48771593,-0.23075569,0.85219818,-0.49773085,0.11289516,0.48208410,0.38989225,1.35772240,0.00687215,-0.11531031,-0.91072911,0.18496628,0.00233038,0.12697171,-0.09528572,-0.30838612
};
static float l2_output_array[20];

static const quicknet::matrix_t l2_weights{20,20,l2_weights_array};
static const quicknet::vector_t l2_bias{20,l2_bias_array};
static quicknet::vector_t l2_output{20,l2_output_array};

/******** Layer 3 ********/
static const float l3_weights_array[300] {
    -0.31838709,-18.33140373,0.19328162,0.36829668,0.23072180,-0.18552388,-1.09295261,0.15526728,-0.27332473,-0.40640134,0.57627827,-0.06756831,-3.14669061,-4.90265417,0.35041204,-0.38216180,0.32024249,0.80287981,-9.50165081,-6.54743242,
    -0.70922667,-0.93247426,-0.54517031,-2.52658153,-0.05100565,-2.14128280,-1.88106251,-0.35873282,-1.08702314,-0.47399122,-0.94307321,-1.68925285,-0.46753818,-1.45024967,-1.21920884,-0.42875564,-1.75676501,-0.92956835,-0.19198696,-0.41404265,
    0.60415721,-11.87750435,-0.61273861,0.21755221,-4.14136839,-0.19427320,-2.51862264,0.67829311,-4.17648983,-0.83071971,-1.76236272,-0.38872230,-5.21373463,-8.76600742,-0.01826628,-6.37265825,0.51472783,2.89474344,-2.36150050,-17.64427185,
    0.29739979,-5.61967611,-0.40319997,0.46789879,-0.20629397,0.31103379,-1.71282446,0.73968202,-1.24205101,-0.61331475,0.01451536,0.26284561,-1.33521891,-3.90839243,0.51630086,-0.36298662,0.58125365,1.63456464,-20.40932274,-0.49456909,
    1.93715477,0.27689433,3.20094538,0.31017244,-0.71693271,-0.09101692,0.23509857,0.45927247,0.53742862,-0.09024818,-0.13315378,-0.25765133,0.29383639,0.35940519,1.59748173,-1.18324518,-0.69863230,-1.37487602,1.30471826,0.64958346,
    -0.64541143,0.56941193,1.50235343,-0.65288621,-0.73308808,-1.19470966,0.94970542,-0.44997397,0.90580249,2.54702139,-0.63566613,0.68693125,-0.15791546,0.80974776,-1.32884574,0.76353544,1.64836872,-1.15284979,0.71365762,0.28519234,
    -0.47215122,0.37189978,-5.68091202,1.52274024,0.95093411,0.66142780,-0.15288505,-0.28858137,-0.07455561,-1.61007679,0.70922911,0.41273221,1.70762408,-0.39139226,-1.17065609,0.74359089,-0.89472473,1.44145966,0.54389125,-0.27746296,
    -0.00860487,0.11597754,-22.84116745,0.01386988,3.66865015,1.15305197,-0.00829843,0.24114712,0.60529625,1.16524971,0.84445566,0.05062716,-3.44613123,0.05750686,0.06890676,-3.97186971,0.08558746,-8.31201553,-1.37470651,0.15017533,
    -0.70705676,-0.86408287,-9.16318798,0.15269345,1.35773921,-1.13105500,0.12175433,-0.53196996,0.20536296,-35.53390503,-0.19548257,-0.33946609,-1.79022074,-0.44573268,0.18890044,1.55905569,0.23031048,0.97081947,1.05274045,0.97599483,
    -4.63860607,-3.38009262,-11.21255589,-0.95832270,2.44502068,-0.81270880,0.20967233,-15.22540569,0.32634345,-40.01359940,4.34047937,-0.96990806,2.16530156,0.17657410,-0.08122969,-1.81551123,0.39690551,-54.57436752,0.82291883,-0.77966470,
    -0.50776327,-1.52660561,-0.75058931,-2.42824841,-0.47995073,-1.87475467,-1.17824018,-0.70554745,-1.64791143,-0.83049047,-1.21721530,-2.07583427,-0.75859070,-1.34796476,-1.20124769,-0.67219806,-1.55718803,-1.32722056,-0.95499659,-0.89567786,
    -0.89201427,-0.85048068,-0.49607351,-2.25691533,-0.73800260,-2.25925612,-1.50972521,-0.61844671,-1.41023767,-0.57191414,-1.15362489,-1.84847760,-0.37682486,-1.32634008,-1.37515891,-0.00942776,-1.48339176,-1.03520489,-0.41329494,-1.14058840,
    -0.19970976,-0.96655470,-0.61457032,-2.65168166,-0.55956060,-2.00785470,-1.29881763,-0.42975619,-1.12652194,-0.33424151,-1.43406451,-1.96093476,-0.50204360,-1.46942091,-1.47566724,-0.29945317,-1.59601259,-0.94981337,-0.68729335,-0.37617171,
    -1.03925788,-0.09940186,-10.79737282,0.51470107,-0.30667499,1.06948614,-0.41418573,0.04099318,-0.57784587,3.44550419,1.19140410,0.40965834,-10.73496056,0.33780733,0.00929113,-8.82012558,0.21599728,1.41718256,-1.85622644,0.10383290,
    -0.23651245,-1.41013515,-0.28347799,-2.38462186,-0.04059101,-1.52123582,-1.56591547,-0.44515520,-1.60991657,-0.41732082,-0.87653959,-1.78394544,-0.56070685,-1.27374494,-1.82741475,-0.32322639,-2.02533340,-0.74263233,-0.67645198,-0.67340815,
};
static float l3_bias_array[15] {
    -0.02560590,-1.31585133,0.00954008,0.04131013,0.02173072,0.38799998,0.42158240,-0.12886538,-0.10727037,-0.63518316,-1.33476138,-1.27217889,-1.24943674,0.04593486,-1.25114357
};
static float l3_output_array[15];

static const quicknet::matrix_t l3_weights{15,20,l3_weights_array};
static const quicknet::vector_t l3_bias{15,l3_bias_array};
static quicknet::vector_t l3_output{15,l3_output_array};

/******** Network ********/
static quicknet::Layer layers[4] {
    {l0_weights, l0_bias, l0_output, quicknet::quick_sigmoid},
    {l1_weights, l1_bias, l1_output, quicknet::quick_sigmoid},
    {l2_weights, l2_bias, l2_output, quicknet::quick_sigmoid},
    {l3_weights, l3_bias, l3_output, quicknet::quick_softmax},
};

NeuralNetwork::NeuralNetwork() : network{4, layers} {
}

} /* namespace dsme */
